import{b as vt,r as x,f as ft,g as bt,c as d,a as t,i,v as s,s as o,j as p,n as gt,k as v,h as mt,m as yt,o as n,G as K,R as P,S as lt,q as _,U as z,p as wt}from"./index-GwBpnSVU.js";import{E as kt}from"./eye-Dra6YFIM.js";import{E as Ct}from"./exit--WL2js6I.js";import{r as St}from"./report.service-y6CgOxt0.js";import{p as jt}from"./product.service-UEhOC2xT.js";import{o as Lt}from"./order.service-CheXL7ad.js";import{c as h}from"./NumberFormat-BDrUmd0_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Dt={class:"p-4"},qt={class:"bg-white rounded-lg shadow-md"},Yt={class:"flex justify-between items-center p-4 bg-gray-100 rounded-t-lg"},Nt={class:"text-xl font-bold"},Bt={class:"flex flex-wrap gap-4 p-2"},Ut={class:"w-[400px] sm:w-[300px]"},Et={class:"w-full sm:w-64"},It={class:"w-full sm:w-64"},Mt={class:"w-full sm:w-64"},Ht={class:"w-full sm:w-auto"},Ot={class:"p-4"},$t={class:"md:hidden space-y-3"},Rt={class:"flex items-center justify-between gap-2"},Vt={class:"text-xs text-slate-500"},Ft={class:"text-xs text-slate-500"},Tt={key:0,class:"shrink-0"},zt={key:1,class:"text-xs px-2 py-0.5 rounded bg-gray-200 text-gray-700"},Jt={class:"mt-2 flex items-start gap-3"},Gt={class:"flex-shrink-0 h-9 w-9 rounded-full bg-slate-100 flex items-center justify-center text-[10px] font-semibold text-slate-600 ring-1 ring-slate-200"},Qt={class:"min-w-0"},At={class:"font-medium leading-tight truncate"},Kt={class:"mt-0.5 flex flex-wrap gap-1.5 text-[11px] text-slate-600"},Pt=["href"],Wt=["href"],Xt={class:"mt-3 grid grid-cols-2 gap-2 items-end"},Zt={class:"text-sm"},te={class:"text-slate-500 text-xs"},ee={class:"font-medium truncate"},se={class:"text-right text-sm"},oe={class:"text-slate-500 text-xs"},ae={class:"font-semibold"},le={class:"mt-2 flex justify-end"},re={class:"rounded-lg border p-3 bg-gray-50"},ne={class:"flex justify-between text-sm"},de={class:"font-semibold"},ce={class:"flex justify-between text-sm mt-1"},ie={class:"font-semibold"},ue={class:"flex justify-between text-sm mt-1"},pe={class:"font-semibold"},_e={class:"hidden md:block"},he={class:"overflow-x-auto"},xe={class:"min-w-full bg-white shadow-md rounded-lg overflow-hidden border table-auto"},ve={class:"bg-gray-200 text-left border"},fe={class:"px-4 py-2 text-sm"},be={class:"px-4 py-2 text-sm"},ge={class:"px-4 py-2 text-sm"},me={class:"px-4 py-2 text-sm"},ye={class:"px-4 py-2 text-sm"},we={class:"px-4 py-2 text-sm"},ke={class:"px-4 py-2 text-sm"},Ce={class:"px-4 py-2 text-sm w-[120px]"},Se={class:"px-4 py-2 border"},je={class:"px-4 py-2 border"},Le={class:"px-4 py-2 border"},De={class:"flex items-start gap-3"},qe={class:"flex-shrink-0 h-8 w-8 rounded-full bg-slate-100 flex items-center justify-center text-[10px] font-semibold text-slate-600 ring-1 ring-slate-200"},Ye={class:"min-w-[220px]"},Ne={class:"font-medium leading-tight"},Be={class:"mt-0.5 flex flex-wrap gap-1.5 text-[11px] text-slate-600"},Ue=["href"],Ee=["href"],Ie={class:"px-4 py-2 border"},Me={class:"px-4 py-2 text-right border"},He={class:"px-4 py-2 text-right border"},Oe={class:"px-4 py-2 text-right border"},$e={class:"px-4 py-2 border"},Re={key:1,class:"text-center rounded py-1 bg-gray-200 text-gray-700"},Ve={class:"px-4 py-2 border"},Fe={key:0},Te={colspan:"9",class:"px-4 py-6 text-center text-slate-500"},ze={class:"bg-gray-100"},Je={colspan:"4",class:"px-4 py-2 text-center font-semibold border"},Ge={class:"px-4 py-2 text-right border"},Qe={class:"px-4 py-2 text-right border"},Ae={class:"px-4 py-2 text-right border"},as={__name:"order_sverka",setup(Ke){const{t:a,locale:f}=vt(),rt=gt(),nt=mt(),W=yt("dayJS"),X=x([]),J=new Date,dt=new Date(J.getFullYear(),J.getMonth(),1);let T=x(!1),Z=x(!0);const u=x({data:[],total_quantity:0,total_amount:0,total_summa:0}),G=ft(()=>{var l;return((l=u.value)==null?void 0:l.data)||[]}),Q=x([]),ct=x([{value:"yes",label:a("yes")},{value:"no",label:a("no")}]),c=x({range:[dt.getTime(),J.getTime()],product_id:null,status:null,paid_action:null}),it=async()=>{try{X.value=await jt.all(),Q.value=await Lt.statusOption()}catch(l){console.log(l)}},b=l=>Q.value.find(r=>r.value===l),ut=()=>{let l=nt.query;l!=null&&l.action&&(c.value.product_id=l.product_id?parseInt(l.product_id):null,c.value.paid_action=l.paid_action,c.value.status=l.status,c.value.range=l.range?[parseInt(l.range[0]),parseInt(l.range[1])]:null,tt())};bt(()=>{ut(),it()});const tt=()=>{T.value=!0,Z.value=!0,St.orderSverka(c.value).then(l=>{u.value=l,T.value=!1,l.data&&l.data.length>0&&(Z.value=!1)})};return(l,r)=>{const et=v("n-icon"),st=v("n-button"),pt=v("n-date-picker"),A=v("n-select"),_t=v("n-ellipsis"),ht=v("n-empty"),xt=v("n-spin");return n(),d("div",Dt,[t("div",qt,[t("div",Yt,[t("h2",Nt,s(o(a)("order sverka")),1),i(st,{onClick:r[0]||(r[0]=e=>o(rt).go(-1)),class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-700"},{icon:p(()=>[i(et,{size:"28"},{default:p(()=>[i(o(Ct))]),_:1})]),default:p(()=>[K(" "+s(o(a)("exit")),1)]),_:1})]),t("div",Bt,[t("div",Ut,[i(pt,{value:c.value.range,"onUpdate:value":r[1]||(r[1]=e=>c.value.range=e),type:"datetimerange",clearable:"",class:"w-full sm:w-[300px]"},null,8,["value"])]),t("div",Et,[i(A,{options:X.value,value:c.value.product_id,"onUpdate:value":r[2]||(r[2]=e=>c.value.product_id=e),"value-field":"id","label-field":"title_"+o(f),placeholder:o(a)("product"),filterable:"",clearable:"",class:"w-full"},null,8,["options","value","label-field","placeholder"])]),t("div",It,[i(A,{options:Q.value,value:c.value.status,"onUpdate:value":r[3]||(r[3]=e=>c.value.status=e),placeholder:o(a)("order")+" "+o(a)("status").toLocaleLowerCase(),filterable:"",clearable:"",class:"w-full","label-field":"label_"+o(f)},null,8,["options","value","placeholder","label-field"])]),t("div",Mt,[i(A,{options:ct.value,value:c.value.paid_action,"onUpdate:value":r[4]||(r[4]=e=>c.value.paid_action=e),placeholder:o(a)("paid"),filterable:"",clearable:"",class:"w-full"},null,8,["options","value","placeholder"])]),t("div",Ht,[i(st,{type:"success",onClick:tt,class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-700 w-full sm:w-auto"},{icon:p(()=>[i(et,null,{default:p(()=>[i(o(kt))]),_:1})]),default:p(()=>[K(" "+s(o(a)("see")),1)]),_:1})])]),t("div",Ot,[i(xt,{show:o(T),class:"w-full"},{default:p(()=>[t("div",$t,[(n(!0),d(P,null,lt(G.value,(e,g)=>{var m,y,w,k,C,S,j,L,D,q,Y,N,B,U,E,I,M,H,O,$,R,V,F,ot,at;return n(),d("div",{key:e.id||g,class:"rounded-lg border p-3 shadow-sm bg-white"},[t("div",Rt,[t("div",Vt,"#"+s(g+1),1),t("div",Ft,s(o(W)((m=e.order)==null?void 0:m.datetime).format("DD.MM.YYYY HH:mm")),1),(y=e.order)!=null&&y.status?(n(),d("div",Tt,[b(e.order.status)?(n(),d("span",{key:0,class:z(["text-xs px-2 py-0.5 rounded",b(e.order.status).color])},s(b(e.order.status)["label_"+o(f)]),3)):(n(),d("span",zt,s(e.order.status),1))])):_("",!0)]),t("div",Jt,[t("div",Gt,s((((C=(k=(w=e.order)==null?void 0:w.client)==null?void 0:k.first_name)==null?void 0:C[0])||((L=(j=(S=e.order)==null?void 0:S.client)==null?void 0:j.mail)==null?void 0:L[0])||"—").toUpperCase()),1),t("div",Qt,[t("div",At,s([(q=(D=e.order)==null?void 0:D.client)==null?void 0:q.first_name,(N=(Y=e.order)==null?void 0:Y.client)==null?void 0:N.last_name].filter(Boolean).join(" ")||((U=(B=e.order)==null?void 0:B.client)==null?void 0:U.mail)||((I=(E=e.order)==null?void 0:E.client)==null?void 0:I.phone_number)||"—"),1),t("div",Kt,[(H=(M=e.order)==null?void 0:M.client)!=null&&H.mail?(n(),d("a",{key:0,href:`mailto:${e.order.client.mail}`,class:"px-2 py-0.5 rounded bg-slate-100 hover:bg-slate-200"},s(e.order.client.mail),9,Pt)):_("",!0),($=(O=e.order)==null?void 0:O.client)!=null&&$.phone_number?(n(),d("a",{key:1,href:`tel:${String(e.order.client.phone_number).replace(/[^\d+]/g,"")}`,class:"px-2 py-0.5 rounded bg-slate-100 hover:bg-slate-200"},s(e.order.client.phone_number),9,Wt)):_("",!0)]),(V=(R=e.order)==null?void 0:R.client)!=null&&V.address?(n(),wt(_t,{key:0,class:"text-[11px] text-slate-500 mt-1",tooltip:!0},{default:p(()=>[K(s(e.order.client.address),1)]),_:2},1024)):_("",!0)])]),t("div",Xt,[t("div",Zt,[t("div",te,s(o(a)("product")),1),t("div",ee,s(((F=e.product)==null?void 0:F["title_"+o(f)])||"—"),1)]),t("div",se,[t("div",oe,s(o(a)("total")),1),t("div",ae,s(e.quantity)+" × "+s(o(h)(e.price))+" = "+s(o(h)((Number(e.quantity)||0)*(Number(e.price)||0))),1)])]),t("div",le,[t("span",{class:z(["text-xs text-white rounded px-2 py-0.5",(ot=e.order)!=null&&ot.paid?"bg-green-500":"bg-red-500"])},s((at=e.order)!=null&&at.paid?o(a)("yes"):o(a)("no")),3)])])}),128)),t("div",re,[t("div",ne,[t("span",null,s(o(a)("total"))+" "+s(o(a)("count").toLocaleLowerCase()),1),t("span",de,s(u.value.total_quantity||0),1)]),t("div",ce,[t("span",null,s(o(a)("price"))+" Σ",1),t("span",ie,s(o(h)(u.value.total_amount)),1)]),t("div",ue,[t("span",null,s(o(a)("total"))+" "+s(o(a)("price").toLocaleLowerCase()),1),t("span",pe,s(o(h)(u.value.total_summa)),1)])])]),t("div",_e,[t("div",he,[t("table",xe,[t("thead",null,[t("tr",ve,[r[5]||(r[5]=t("th",{class:"px-4 py-2 text-sm w-10"},"#",-1)),t("th",fe,s(o(a)("datetime")),1),t("th",be,s(o(a)("client_one")),1),t("th",ge,s(o(a)("product")),1),t("th",me,s(o(a)("total"))+" "+s(o(a)("count").toLocaleLowerCase()),1),t("th",ye,s(o(a)("price")),1),t("th",we,s(o(a)("total"))+" "+s(o(a)("price").toLocaleLowerCase()),1),t("th",ke,s(o(a)("status")),1),t("th",Ce,s(o(a)("paid")),1)])]),t("tbody",null,[(n(!0),d(P,null,lt(G.value,(e,g)=>{var m,y,w,k,C,S,j,L,D,q,Y,N,B,U,E,I,M,H,O,$,R,V,F;return n(),d("tr",{key:e.id||g,class:"border hover:bg-gray-50 cursor-pointer"},[t("td",Se,s(g+1),1),t("td",je,s(o(W)((m=e.order)==null?void 0:m.datetime).format("DD.MM.YYYY HH:mm")),1),t("td",Le,[t("div",De,[t("div",qe,s((((k=(w=(y=e.order)==null?void 0:y.client)==null?void 0:w.first_name)==null?void 0:k[0])||((j=(S=(C=e.order)==null?void 0:C.client)==null?void 0:S.mail)==null?void 0:j[0])||"—").toUpperCase()),1),t("div",Ye,[t("div",Ne,s([(D=(L=e.order)==null?void 0:L.client)==null?void 0:D.first_name,(Y=(q=e.order)==null?void 0:q.client)==null?void 0:Y.last_name].filter(Boolean).join(" ")||((B=(N=e.order)==null?void 0:N.client)==null?void 0:B.mail)||((E=(U=e.order)==null?void 0:U.client)==null?void 0:E.phone_number)||"—"),1),t("div",Be,[(M=(I=e.order)==null?void 0:I.client)!=null&&M.mail?(n(),d("a",{key:0,href:`mailto:${e.order.client.mail}`,class:"px-2 py-0.5 rounded bg-slate-100 hover:bg-slate-200"},s(e.order.client.mail),9,Ue)):_("",!0),(O=(H=e.order)==null?void 0:H.client)!=null&&O.phone_number?(n(),d("a",{key:1,href:`tel:${String(e.order.client.phone_number).replace(/[^\d+]/g,"")}`,class:"px-2 py-0.5 rounded bg-slate-100 hover:bg-slate-200"},s(e.order.client.phone_number),9,Ee)):_("",!0)])])])]),t("td",Ie,s(($=e.product)==null?void 0:$["title_"+o(f)]),1),t("td",Me,s(e.quantity),1),t("td",He,s(o(h)(e.price)),1),t("td",Oe,s(o(h)((Number(e.quantity)||0)*(Number(e.price)||0))),1),t("td",$e,[(R=e.order)!=null&&R.status?(n(),d(P,{key:0},[b(e.order.status)?(n(),d("div",{key:0,class:z(["text-center","rounded","py-1",b(e.order.status).color])},s(b(e.order.status)["label_"+o(f)]),3)):(n(),d("div",Re,s(e.order.status),1))],64)):_("",!0)]),t("td",Ve,[t("div",{class:z(["text-center text-white","rounded","py-1 px-2",(V=e.order)!=null&&V.paid?"bg-green-500":"bg-red-500"])},s((F=e.order)!=null&&F.paid?o(a)("yes"):o(a)("no")),3)])])}),128)),!G.value.length&&!o(T)?(n(),d("tr",Fe,[t("td",Te,[i(ht)])])):_("",!0),t("tr",ze,[t("td",Je,s(o(a)("total")),1),t("td",Ge,s(u.value.total_quantity||0),1),t("td",Qe,s(o(h)(u.value.total_amount)),1),t("td",Ae,s(o(h)(u.value.total_summa)),1),r[6]||(r[6]=t("td",{class:"border"},null,-1)),r[7]||(r[7]=t("td",{class:"border"},null,-1))])])])])])]),_:1},8,["show"])])])])}}};export{as as default};
