import{R as K}from"./refresh-DtjYAjoi.js";import{D as W}from"./delete-Bo7FBPv5.js";import{O as v,d as Z,f as ee,H as te,r as b,n as q,h as le,w as ae,c as _,a as e,j as u,s as ne,l as y,t,U as z,k as i,L as V,x as a,p as se,o as d,G as h,N as H,Q as N,R as O,q as L,V as oe}from"./index-BkkmJgWg.js";import{c as ue}from"./clients.service-DIyU-Tav.js";import{c as S}from"./NumberFormat-Dorb8or7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const x="/order";class re{all(l){return v.post(x+"/all",l).then(s=>s)}create(l){return v.post(x+"/",l).then(s=>s)}update(l,s){return v.patch(x+`/update${l}`,s).then(c=>c)}updateStatus(l,s){return v.patch(x+`/updateStatus/${l}`,s).then(c=>c)}getOne(l){return v.get(x+`/${l}`).then(s=>s)}delete(l){return v.delete(x+`/${l}`).then(s=>s)}}const U=new re,ie={class:"space-y-2 p-2"},de={class:"flex justify-between flex-wrap items-center gap-2"},ce={class:"flex gap-2 items-center flex-wrap"},pe={class:"grid gap-2 grid-cols-[repeat(auto-fill,minmax(320px,1fr))] md:grid-cols-[repeat(auto-fill,minmax(620px,1fr))]"},me=["href"],_e=["href"],he=["href"],fe={class:"flex gap-2"},ge={key:1},ve={class:"mt-2 space-y-1"},ye={class:"font-semibold text-lg text-bold-700"},xe={style:{width:"50px","text-align":"center"}},be={class:"text-right"},we={class:"text-right"},ke={class:"text-right"},Se={class:"flex justify-end gap-2 mt-4"},Me={key:0,class:"flex flex-col items-center justify-center p-6 bg-gray-100 rounded-2xl border border-dashed border-gray-300 shadow-sm"},$e={class:"text-gray-600 text-lg font-medium"},De={__name:"Index",setup(R){const{t:l,locale:s}=Z(),c=ee();se();const B=te(),M=b([]),$=b(!1),C=q("dayJS"),T=q("fileUrl"),w=b("pending"),j=b([]),g=b({range:[C().subtract(6,"day").startOf("day").valueOf(),C().endOf("day").valueOf()],status:"pending"}),f=async()=>{$.value=!0;try{M.value=await U.all(g.value)}finally{$.value=!1}},Y=async()=>{try{j.value=await ue.all()}catch{}},G=async(m,o)=>{try{await U.updateStatus(m,{status:o}),B.success(l("updated status")),f()}catch{B.error("Xatolik yuz berdi")}},E=m=>{let o=c.orderStatus.find(k=>k["label_"+s.value]==m);g.value.status=o.value,w.value=m,f()};return le(()=>{Y(),f()}),ae(()=>s.value,m=>{c.orderStatus.length>0&&(w.value=c.orderStatus[0]["label_"+m])},{immediate:!0}),(m,o)=>{const k=y("n-date-picker"),F=y("n-image"),J=y("n-table"),A=y("n-scrollbar"),P=y("n-tab-pane"),Q=y("n-tabs");return d(),_("div",ie,[e("div",de,[e("div",ce,[o[3]||(o[3]=e("h2",{class:"text-2xl font-bold"},"Buyurtmalar",-1)),u(k,{style:{"min-width":"300px"},value:g.value.range,"onUpdate:value":[o[0]||(o[0]=p=>g.value.range=p),f],type:"daterange"},null,8,["value"]),e("div",null,[u(t(z),{options:j.value,value:g.value.client_id,"onUpdate:value":[o[1]||(o[1]=p=>g.value.client_id=p),f],placeholder:t(l)("client_one"),filterable:"",clearable:"","label-field":"fullname","value-field":"id"},null,8,["options","value","placeholder"])])]),u(t(V),{type:"warning",onClick:f},{icon:i(()=>[u(t(H),null,{default:i(()=>[u(t(K))]),_:1})]),default:i(()=>[h(" "+a(t(l)("update")),1)]),_:1})]),u(Q,{type:"line",animated:"",value:w.value,"onUpdate:value":[o[2]||(o[2]=p=>w.value=p),E]},{default:i(()=>[(d(!0),_(N,null,O(t(c).orderStatus,p=>(d(),L(P,{key:p.value,name:p["label_"+t(s)],tab:p["label_"+t(s)]},{default:i(()=>[e("div",pe,[(d(!0),_(N,null,O(M.value,n=>(d(),_("div",{key:n.id},[u(t(oe),{title:`${t(l)("order")} #${n.id} ${n.client.first_name} ${n.client.last_name}`,size:"medium"},{"header-extra":i(()=>[u(t(z),{style:{"min-width":"180px"},value:n.status,"onUpdate:value":[r=>n.status=r,r=>G(n.id,r)],options:t(c).orderStatus,"label-field":"label_"+t(s),size:"small"},null,8,["value","onUpdate:value","options","label-field"])]),default:i(()=>[e("p",null,[e("strong",null,a(t(l)("datetime"))+":",1),h(" "+a(t(C)(n.datetime).format("YYYY-MM-DD HH:mm:ss")),1)]),e("p",null,[e("strong",null,a(t(l)("phone"))+":",1),e("a",{href:"tel:"+n.client.phone_number,class:"text-blue-500"},a(n.client.phone_number),9,me)]),e("p",null,[e("strong",null,a(t(l)("additional phone number"))+":",1),e("a",{href:"tel:"+n.phone2,class:"text-blue-500"},a(n.phone2),9,_e)]),e("p",null,[e("strong",null,a(t(l)("address"))+":",1),h(" "+a(n.address),1)]),e("p",null,[e("strong",null,a(t(l)("location"))+":",1),e("a",{class:"text-blue-500",href:`https://www.google.com/maps?q=${n.lat},${n.lon}`,target:"_blank",style:{"text-decoration":"none"}}," 📍 Google Map ",8,he)]),e("p",null,[e("strong",null,a(t(l)("comment"))+":",1),h(" "+a(n.comment),1)]),e("p",null,[e("strong",null,a(t(l)("pay_type"))+":",1),h(" "+a(n.payment_type),1)]),e("p",null,[e("strong",null,a(t(l)("total")+" "+t(l)("summa").toLocaleLowerCase())+":",1),h(" "+a(t(S)(n.total_price)),1)]),e("p",null,[e("strong",null,a(t(l)("delivery_summa"))+":",1),h(" "+a(t(S)(n.delivery_summa)),1)]),e("div",fe,[e("strong",null,a(t(l)("payment image"))+":",1),n.payment_image?(d(),L(F,{key:0,width:"100",src:t(T)+n.payment_image},null,8,["src"])):(d(),_("span",ge,a(t(l)("image not found")),1))]),e("div",ve,[e("h2",ye,a(t(l)("products"))+":",1),u(A,{style:{"max-height":"300px","max-width":"800px"},"x-scrollable":""},{default:i(()=>[u(J,{size:"small",bordered:!0,"single-line":!1},{default:i(()=>[e("thead",null,[e("tr",null,[o[4]||(o[4]=e("th",{style:{width:"50px","text-align":"center"}},"№",-1)),e("th",null,a(t(l)("product")),1),e("th",null,a(t(l)("quantity")),1),e("th",null,a(t(l)("price")),1),e("th",null,a(t(l)("total")+" "+t(l)("summa")),1)])]),e("tbody",null,[(d(!0),_(N,null,O(n.products,(r,X)=>{var D,I;return d(),_("tr",{key:r.id},[e("td",xe,a(X+1),1),e("td",null,a((D=r.product)==null?void 0:D["title_"+t(s)]),1),e("td",be,a(r.quantity)+" "+a(t(l)((I=r.product)==null?void 0:I.unit)),1),e("td",we,a(t(S)(r.price)),1),e("td",ke,a(t(S)(r.price*r.quantity)),1)])}),128))])]),_:2},1024)]),_:2},1024)]),e("div",Se,[u(t(V),{size:"small",type:"error",onClick:r=>t(U).delete(n.id).then(f)},{icon:i(()=>[u(t(H),null,{default:i(()=>[u(t(W))]),_:1})]),default:i(()=>[h(" "+a(t(l)("delete")),1)]),_:2},1032,["onClick"])])]),_:2},1032,["title"])]))),128))])]),_:2},1032,["name","tab"]))),128))]),_:1},8,["value"]),!$.value&&M.value.length===0?(d(),_("div",Me,[o[5]||(o[5]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-16 w-16 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 3h18M3 7h18M5 11h14M7 15h10M9 19h6"})],-1)),e("p",$e,a(t(l)("order not available")),1)])):ne("",!0)])}}};export{De as default};
