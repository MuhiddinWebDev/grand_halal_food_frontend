import{R as Y}from"./refresh-HJby1V2m.js";import{D as j}from"./delete-WaA4XgRx.js";import{O as _,d as V,h as G,e as H,H as J,r as N,j as R,k as T,o as c,c as d,a as t,l as r,m as i,p as e,q as U,P as $,Q as C,N as q,G as u,t as l,J as g,T as E,U as F,v as P}from"./index-cPQIZp5h.js";import{c as z}from"./NumberFormat-N2x_sffK.js";import"./_plugin-vue_export-helper-x3n3nnut.js";const h="/order";class L{all(s){return _.get(h+"/all").then(n=>n)}create(s){return _.post(h+"/",s).then(n=>n)}update(s,n){return _.patch(h+`/${s}`,n).then(p=>p)}getOne(s){return _.get(h+`/${s}`).then(n=>n)}delete(s){return _.delete(h+`/${s}`).then(n=>n)}}const y=new L,Q={class:"space-y-4 p-4"},X={class:"flex justify-between items-center"},A=t("h2",{class:"text-2xl font-bold"},"Buyurtmalar",-1),K={key:0},W={class:"space-y-4 grid grid-cols-1 md:grid-cols-2 gap-4"},Z=["href"],tt=["href"],et=t("a",{class:"text-blue-500",href:"https://www.google.com/maps?q={{order.lat}},{{order.lon}}",target:"_blank",style:{"text-decoration":"none"}}," 📍 Google Map ",-1),st={class:"mt-2 space-y-1"},lt={class:"font-semibold text-lg text-bold-700"},at=t("th",{style:{width:"50px","text-align":"center"}},"№",-1),nt={style:{width:"50px","text-align":"center"}},ot={class:"text-right"},rt={class:"text-right"},it={class:"text-right"},ut={class:"flex justify-end gap-2 mt-4"},mt={__name:"Index",setup(B){const{t:s,locale:n}=V(),p=G(),D=H(),x=J(),v=N([]),m=N(!1),I=P("dayJS"),f=async()=>{m.value=!0;try{v.value=await y.all()}finally{m.value=!1}},O=async(b,k)=>{try{await y.updateStatus(b,{status:k}),x.success("Status yangilandi")}catch{x.error("Xatolik yuz berdi")}};return R(()=>f()),(b,k)=>{const S=T("n-table");return c(),d("div",Q,[t("div",X,[A,r(e(g),{type:"warning",onClick:f},{icon:i(()=>[r(e(q),null,{default:i(()=>[r(e(Y))]),_:1})]),default:i(()=>[u(" "+l(e(s)("update")),1)]),_:1})]),m.value?(c(),d("div",K,"Yuklanmoqda...")):U("",!0),t("div",W,[(c(!0),d($,null,C(v.value,a=>(c(),d("div",{key:a.id},[r(e(F),{title:`${e(s)("order")} #${a.id} ${a.client.first_name} ${a.client.last_name}`,size:"medium"},{"header-extra":i(()=>[r(e(E),{value:a.status,"onUpdate:value":[o=>a.status=o,o=>O(a.id,o)],options:e(p).orderStatus,"label-field":"label_"+e(n),size:"small"},null,8,["value","onUpdate:value","options","label-field"])]),default:i(()=>[t("p",null,[t("strong",null,l(e(s)("datetime"))+":",1),u(" "+l(e(I)(a.datetime).format("YYYY-MM-DD HH:mm:ss")),1)]),t("p",null,[t("strong",null,l(e(s)("phone"))+":",1),u(),t("a",{href:"tel:"+a.client.phone_number,class:"text-blue-500"},l(a.client.phone_number),9,Z)]),t("p",null,[t("strong",null,l(e(s)("additional phone number"))+":",1),u(),t("a",{href:"tel:"+a.phone2,class:"text-blue-500"},l(a.phone2),9,tt)]),t("p",null,[t("strong",null,l(e(s)("address"))+":",1),u(" "+l(a.address),1)]),t("p",null,[t("strong",null,l(e(s)("location"))+":",1),et]),t("div",st,[t("h2",lt,l(e(s)("products"))+":",1),r(S,{size:"small",bordered:!0,"single-line":!1},{default:i(()=>[t("thead",null,[t("tr",null,[at,t("th",null,l(e(s)("product")),1),t("th",null,l(e(s)("quantity")),1),t("th",null,l(e(s)("price")),1),t("th",null,l(e(s)("total")+" "+e(s)("summa")),1)])]),t("tbody",null,[(c(!0),d($,null,C(a.items,(o,M)=>{var w;return c(),d("tr",{key:o.id},[t("td",nt,l(M+1),1),t("td",null,l((w=o.product)==null?void 0:w["title_"+e(n)]),1),t("td",ot,l(o.quantity),1),t("td",rt,l(e(z)(o.price)),1),t("td",it,l(e(z)(o.price*o.quantity)),1)])}),128))])]),_:2},1024)]),t("div",ut,[r(e(g),{size:"small",type:"info",onClick:o=>e(D).push(`/orders/${a.id}`)},{default:i(()=>[u(" Batafsil ")]),_:2},1032,["onClick"]),r(e(g),{size:"small",type:"error",onClick:o=>e(y).delete(a.id).then(f)},{icon:i(()=>[r(e(q),null,{default:i(()=>[r(e(j))]),_:1})]),default:i(()=>[u(" O'chirish ")]),_:2},1032,["onClick"])])]),_:2},1032,["title"])]))),128))])])}}};export{mt as default};
