import{R as Y}from"./refresh-DXOwnIIO.js";import{D as V}from"./delete-BSde0mvZ.js";import{O as m,d as G,f as H,H as R,r as C,h as T,c as d,a as t,s as M,j as u,k as i,t as e,L as x,P as N,Q as $,p as U,n as E,l as F,o as c,G as p,x as l,N as B,T as J,U as L}from"./index-AFM4ajz-.js";import{c as j}from"./NumberFormat-Dorb8or7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const h="/order";class P{all(s){return m.get(h+"/all").then(o=>o)}create(s){return m.post(h+"/",s).then(o=>o)}update(s,o){return m.patch(h+`/${s}`,o).then(g=>g)}getOne(s){return m.get(h+`/${s}`).then(o=>o)}delete(s){return m.delete(h+`/${s}`).then(o=>o)}}const v=new P,Q={class:"space-y-4 p-4"},X={class:"flex justify-between items-center"},A={key:0},K={class:"space-y-4 grid grid-cols-1 md:grid-cols-2 gap-4"},W=["href"],Z=["href"],tt={class:"mt-2 space-y-1"},et={class:"font-semibold text-lg text-bold-700"},st={style:{width:"50px","text-align":"center"}},lt={class:"text-right"},nt={class:"text-right"},at={class:"text-right"},ot={class:"flex justify-end gap-2 mt-4"},rt={key:1,class:"flex flex-col items-center justify-center p-6 bg-gray-100 rounded-2xl border border-dashed border-gray-300 shadow-sm"},mt={__name:"Index",setup(z){const{t:s,locale:o}=G(),g=H(),D=U(),b=R(),_=C([]),f=C(!1),I=E("dayJS"),y=async()=>{f.value=!0;try{_.value=await v.all()}finally{f.value=!1}},O=async(k,n)=>{try{await v.updateStatus(k,{status:n}),b.success("Status yangilandi")}catch{b.error("Xatolik yuz berdi")}};return T(()=>y()),(k,n)=>{const w=F("n-table");return c(),d("div",Q,[t("div",X,[n[0]||(n[0]=t("h2",{class:"text-2xl font-bold"},"Buyurtmalar",-1)),u(e(x),{type:"warning",onClick:y},{icon:i(()=>[u(e(B),null,{default:i(()=>[u(e(Y))]),_:1})]),default:i(()=>[p(" "+l(e(s)("update")),1)]),_:1})]),f.value?(c(),d("div",A,"Yuklanmoqda...")):M("",!0),t("div",K,[(c(!0),d(N,null,$(_.value,a=>(c(),d("div",{key:a.id},[u(e(L),{title:`${e(s)("order")} #${a.id} ${a.client.first_name} ${a.client.last_name}`,size:"medium"},{"header-extra":i(()=>[u(e(J),{value:a.status,"onUpdate:value":[r=>a.status=r,r=>O(a.id,r)],options:e(g).orderStatus,"label-field":"label_"+e(o),size:"small"},null,8,["value","onUpdate:value","options","label-field"])]),default:i(()=>[t("p",null,[t("strong",null,l(e(s)("datetime"))+":",1),p(" "+l(e(I)(a.datetime).format("YYYY-MM-DD HH:mm:ss")),1)]),t("p",null,[t("strong",null,l(e(s)("phone"))+":",1),n[1]||(n[1]=p()),t("a",{href:"tel:"+a.client.phone_number,class:"text-blue-500"},l(a.client.phone_number),9,W)]),t("p",null,[t("strong",null,l(e(s)("additional phone number"))+":",1),n[2]||(n[2]=p()),t("a",{href:"tel:"+a.phone2,class:"text-blue-500"},l(a.phone2),9,Z)]),t("p",null,[t("strong",null,l(e(s)("address"))+":",1),p(" "+l(a.address),1)]),t("p",null,[t("strong",null,l(e(s)("location"))+":",1),n[3]||(n[3]=t("a",{class:"text-blue-500",href:"https://www.google.com/maps?q={{order.lat}},{{order.lon}}",target:"_blank",style:{"text-decoration":"none"}}," ðŸ“ Google Map ",-1))]),t("div",tt,[t("h2",et,l(e(s)("products"))+":",1),u(w,{size:"small",bordered:!0,"single-line":!1},{default:i(()=>[t("thead",null,[t("tr",null,[n[4]||(n[4]=t("th",{style:{width:"50px","text-align":"center"}},"â„–",-1)),t("th",null,l(e(s)("product")),1),t("th",null,l(e(s)("quantity")),1),t("th",null,l(e(s)("price")),1),t("th",null,l(e(s)("total")+" "+e(s)("summa")),1)])]),t("tbody",null,[(c(!0),d(N,null,$(a.items,(r,q)=>{var S;return c(),d("tr",{key:r.id},[t("td",st,l(q+1),1),t("td",null,l((S=r.product)==null?void 0:S["title_"+e(o)]),1),t("td",lt,l(r.quantity),1),t("td",nt,l(e(j)(r.price)),1),t("td",at,l(e(j)(r.price*r.quantity)),1)])}),128))])]),_:2},1024)]),t("div",ot,[u(e(x),{size:"small",type:"info",onClick:r=>e(D).push(`/orders/${a.id}`)},{default:i(()=>n[5]||(n[5]=[p(" Batafsil ")])),_:2,__:[5]},1032,["onClick"]),u(e(x),{size:"small",type:"error",onClick:r=>e(v).delete(a.id).then(y)},{icon:i(()=>[u(e(B),null,{default:i(()=>[u(e(V))]),_:1})]),default:i(()=>[n[6]||(n[6]=p(" O'chirish "))]),_:2,__:[6]},1032,["onClick"])])]),_:2},1032,["title"])]))),128))]),!f.value&&_.value.length===0?(c(),d("div",rt,n[7]||(n[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-16 w-16 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 3h18M3 7h18M5 11h14M7 15h10M9 19h6"})],-1),t("p",{class:"text-gray-600 text-lg font-medium"},"Buyurtma mavjud emas",-1)]))):M("",!0)])}}};export{mt as default};
