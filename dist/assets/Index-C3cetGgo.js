import{d as T,r as f,h as V,l as p,q as L,o as G,k as o,j as e,a as m,x as b,t as n,I as P,e as F,J as Z,f as H,g as J,m as y,K as Q,L as W,O as A,N as E,P as X,w as Y,D as ee,c as te,n as le,p as ae}from"./index-DWxUX1dU.js";import{u as oe}from"./index-BuwZsw5p.js";import{A as ne}from"./add-XzjOS7Dh.js";import{R as se}from"./refresh-C64adBlx.js";import{P as ie}from"./pen-Bx9jLVDb.js";import{S as re}from"./search-B-6qYulp.js";import{D as ue}from"./delete-BDP5JkF-.js";import{b as N}from"./brand.service-BKblS6ah.js";import{C as de}from"./category.service-BR02mFs7.js";import{S as ce,E as pe}from"./exit-yk3TINHu.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const me={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-4 sm:space-y-0"},fe={class:"text-xl font-semibold"},_e={class:"flex gap-2"},ve={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4"},M={__name:"Form",props:{type:String,id:[String,Number]},emits:["create","update","close"],setup(O,{emit:r}){const{t:d,locale:q}=T(),_=O,I=r,B=f(null),h=f(!1),K=f(null),R=f([]),i=f({title_uz:"",title_ru:"",title_ko:"",title_en:"",category_id:null}),k=()=>{de.all().then(s=>{R.value=s})},u=s=>({required:!0,trigger:"blur",validator:(a,x)=>{if(!x)return new Error(d(s==="image"?"require_image":"require_name"))}}),g={title_uz:u("title_uz"),title_ko:u("title_ko"),title_ru:u("title_ru"),title_en:u("title_en"),category_id:{required:!0,trigger:"blur",validator:(s,a)=>{if(!a)return new Error(d("require_category"))}}};V(async()=>{if(k(),_.type==="update"&&_.id)try{const s=await N.getOne(_.id);i.value=s}catch(s){console.error("Ma'lumot yuklashda xatolik:",s)}setTimeout(()=>{var s;(s=K.value)==null||s.focus()},100)});const $=async()=>{var s;try{if(await((s=B.value)==null?void 0:s.validate()),h.value=!0,_.type==="create"){const a=await N.create(i.value);I("create",a)}else if(_.type==="update"){const a=await N.update(_.id,i.value);I("update",a)}}catch(a){console.warn("Form not valid or failed",a)}finally{h.value=!1}},C=()=>I("close"),w=s=>{s.code==="Enter"&&$()};return(s,a)=>{const x=p("n-icon"),U=p("n-button"),D=p("n-select"),l=p("n-form-item"),t=p("n-input"),z=p("n-spin"),S=p("n-form");return G(),L(S,{ref_key:"formRef",ref:B,model:i.value,rules:g},{default:o(()=>[e(z,{show:h.value},{default:o(()=>[m("div",me,[m("p",fe,b(n(d)("brand"))+" "+b(_.type=="create"?n(d)("add").toLowerCase():n(d)("change").toLowerCase()),1),m("div",_e,[e(U,{onClick:$,type:"success",disabled:h.value,class:"min-w-[120px]"},{icon:o(()=>[e(x,null,{default:o(()=>[e(n(ce))]),_:1})]),default:o(()=>[P(" "+b(n(d)("save"))+" ",1),a[5]||(a[5]=m("span",{class:"text-xs ml-1"},"Enter",-1))]),_:1,__:[5]},8,["disabled"]),e(U,{onClick:C,type:"warning",class:"min-w-[120px]"},{icon:o(()=>[e(x,null,{default:o(()=>[e(n(pe))]),_:1})]),default:o(()=>[P(" "+b(n(d)("exit"))+" ",1),a[6]||(a[6]=m("span",{class:"text-xs ml-1"},"Esc",-1))]),_:1,__:[6]})])]),e(l,{label:n(d)("category"),path:"category_id"},{default:o(()=>[e(D,{options:R.value,fitlerable:"",clearable:"",onKeydown:w,value:i.value.category_id,"onUpdate:value":a[0]||(a[0]=c=>i.value.category_id=c),"label-field":"title_"+n(q),"value-field":"id"},null,8,["options","value","label-field"])]),_:1},8,["label"]),m("div",ve,[e(l,{label:n(d)("title")+" UZB",path:"title_uz"},{default:o(()=>[e(t,{ref_key:"inputInstRef",ref:K,onKeydown:w,value:i.value.title_uz,"onUpdate:value":a[1]||(a[1]=c=>i.value.title_uz=c),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),e(l,{label:n(d)("title")+" KOR",path:"title_ko"},{default:o(()=>[e(t,{onKeydown:w,value:i.value.title_ko,"onUpdate:value":a[2]||(a[2]=c=>i.value.title_ko=c),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),e(l,{label:n(d)("title")+" RUS",path:"title_ru"},{default:o(()=>[e(t,{onKeydown:w,value:i.value.title_ru,"onUpdate:value":a[3]||(a[3]=c=>i.value.title_ru=c),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),e(l,{label:n(d)("title")+" ENG",path:"title_en"},{default:o(()=>[e(t,{onKeydown:w,value:i.value.title_en,"onUpdate:value":a[4]||(a[4]=c=>i.value.title_en=c),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"])])]),_:1},8,["show"])]),_:1},8,["model"])}}},ge={class:"p-2 space-y-2 bg-white rounded-xl shadow-md overflow-x-auto"},ye={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},we={class:"text-xl font-bold"},xe={class:"flex flex-col sm:flex-row gap-2 sm:items-center"},Be={__name:"Index",setup(O){const{t:r,locale:d}=T(),{insert:q,shift:_,r:I}=oe();ae();const B=F(),h=Z();H();const K=le("fileUrl"),R=f([]),i=f(!1);f(!1);const k=f({text:""}),u=f({create:!1,update:!1,update_id:null}),g=l=>{i.value=!0,N.all(k.value).then(t=>{R.value=t,i.value=!1,l&&(u.value[l]=!1)})},$=J(()=>[{title:"â„–",key:"id",align:"center",width:50,render:(l,t)=>t+1},{title:r("category"),key:"title",render(l){var t,z,S;return y("div",{class:"flex items-center"},[(t=l.category)!=null&&t.image?y(Q,{src:K+((z=l.category)==null?void 0:z.image),height:35,width:50,style:{borderRadius:"35px",marginRight:"8px"},lazy:!0,previewDisabled:!0}):y(W,{size:"small",style:{marginRight:"8px"}}),y("span",{class:"font-semibold"},(S=l.category)==null?void 0:S["title_"+d.value])])}},{title:r("title")+" UZB",key:"title_uz"},{title:r("title")+" KOR",key:"title_ko"},{title:r("title")+" RUS",key:"title_ru"},{title:r("title")+" ENG",key:"title_en"},{title:r("action"),key:"action",align:"center",width:120,fixed:"right",render(l){return[y(A,{size:"small",type:"success",onClick:t=>{u.value.update_id=l.id,u.value.update=!0},style:{marginRight:"8px"}},{icon:()=>y(E,{component:ie,size:22})}),y(A,{size:"small",type:"warning",onClick:()=>{B.warning({title:r("warning"),content:r("delete_row"),positiveText:r("yes"),negativeText:r("no"),onPositiveClick:()=>{N.delete(l.id).then(()=>g())},onNegativeClick:()=>h.success(r("cancel"))})}},{icon:()=>y(E,{component:ue,size:22})})]}}]),C=X({page:1,pageSize:10,showSizePicker:!0,pageSizes:[10,15,20],onChange:l=>C.page=l,onUpdatePageSize:l=>{C.pageSize=l,C.page=1}}),w=l=>({style:"cursor: pointer;"}),s=()=>g(),a=()=>{k.value.text="",g()},x=()=>u.value.create=!0,U=l=>u.value[l]=!1,D=l=>g(l);return Y(q,l=>l&&x()),ee(()=>{_.value&&I.value&&g()}),V(()=>g()),(l,t)=>{const z=p("n-input"),S=p("n-data-table"),c=p("n-card"),j=p("n-modal");return G(),te("div",ge,[m("div",ye,[m("h2",we,b(n(r)("brand")),1),m("div",xe,[e(z,{value:k.value.text,"onUpdate:value":t[0]||(t[0]=v=>k.value.text=v),onInput:s,placeholder:n(r)("search"),clearable:"",class:"w-full sm:w-80"},{prefix:o(()=>[e(n(E),null,{default:o(()=>[e(n(re))]),_:1})]),_:1},8,["value","placeholder"]),e(n(A),{type:"warning",onClick:a},{icon:o(()=>[e(n(E),null,{default:o(()=>[e(n(se))]),_:1})]),default:o(()=>[P(" "+b(n(r)("update"))+" ",1),t[7]||(t[7]=m("span",{class:"ml-1 text-xs"},"Shift+R",-1))]),_:1,__:[7]}),e(n(A),{type:"success",onClick:x},{icon:o(()=>[e(n(E),null,{default:o(()=>[e(n(ne))]),_:1})]),default:o(()=>[P(" "+b(n(r)("add"))+" ",1),t[8]||(t[8]=m("span",{class:"ml-1 text-xs"},"Insert",-1))]),_:1,__:[8]})])]),e(S,{"row-props":w,pagination:C,loading:i.value,columns:$.value,data:R.value,bordered:!0,"single-line":!1,size:"small","scroll-x":1300,"max-height":"calc(100vh - 315px)"},null,8,["pagination","loading","columns","data"]),e(j,{"transform-origin":"center",show:u.value.create,"onUpdate:show":t[3]||(t[3]=v=>u.value.create=v)},{default:o(()=>[e(c,{class:"w-full max-w-3xl",bordered:!1,role:"dialog","aria-modal":"true"},{default:o(()=>[e(M,{onClose:t[1]||(t[1]=v=>U("create")),onCreate:t[2]||(t[2]=v=>D("create")),type:"create"})]),_:1})]),_:1},8,["show"]),e(j,{"transform-origin":"center",show:u.value.update,"onUpdate:show":t[6]||(t[6]=v=>u.value.update=v)},{default:o(()=>[e(c,{class:"w-full max-w-3xl",bordered:!1,role:"dialog","aria-modal":"true"},{default:o(()=>[e(M,{type:"update",id:u.value.update_id,onClose:t[4]||(t[4]=v=>U("update")),onUpdate:t[5]||(t[5]=v=>D("update"))},null,8,["id"])]),_:1})]),_:1},8,["show"])])}}};export{Be as default};
