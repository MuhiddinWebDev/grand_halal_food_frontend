import{O as h,d as K,r as f,j as M,k as m,o as j,n as z,m as n,l as t,a as x,t as b,p as d,G as U,e as P,g as V,H as F,h as G,i as H,c as T,v as A,x as B,N as J,J as L}from"./index-MvcmIAHN.js";import{u as q}from"./index-jD1PkHCZ.js";import{P as Q}from"./pen-c4uF0oPP.js";import{S as W,E as X}from"./exit-VYg3ZfL6.js";import"./_plugin-vue_export-helper-x3n3nnut.js";const k="/contact";class Y{all(a){let l=a!=null&&a.text?"?text="+a.text:"";return h.get(k+"/all"+l).then(_=>_)}create(a){return h.post(k+"/create",a).then(l=>l)}update(a,l){return h.patch(k+`/update/${a}`,l).then(_=>_)}getOne(a){return h.get(k+`/getById/${a}`).then(l=>l)}delete(a){return h.delete(k+`/delete/${a}`).then(l=>l)}}const I=new Y,Z={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-4 sm:space-y-0"},ee={class:"text-xl font-semibold"},te={class:"flex gap-2"},ae=x("span",{class:"text-xs ml-1"},"Enter",-1),le=x("span",{class:"text-xs ml-1"},"Esc",-1),D={__name:"Form",props:{type:String,id:[String,Number]},emits:["update","close"],setup(E,{emit:a}){const{t:l,locale:_}=K(),p=E,C=a,u=f(null),v=f(!1);f(null);const o=f({telegram:"",instagram:"",tiktok:"",phone:""}),$={};M(async()=>{if(p.type==="update"&&p.id)try{const r=await I.getOne(p.id);o.value=r}catch(r){console.error("Ma'lumot yuklashda xatolik:",r)}});const w=async()=>{try{if(v.value=!0,p.type==="update"){const r=await I.update(p.id,o.value);C("update",r)}}catch(r){console.warn("Form not valid or failed",r)}finally{v.value=!1}},s=()=>C("close"),e=r=>{r.code==="Enter"&&w()};return(r,i)=>{const y=m("n-icon"),c=m("n-button"),N=m("n-input"),S=m("n-form-item"),O=m("n-spin"),R=m("n-form");return j(),z(R,{ref_key:"formRef",ref:u,model:o.value,rules:$},{default:n(()=>[t(O,{show:v.value},{default:n(()=>[x("div",Z,[x("p",ee,b(d(l)("contact"))+" "+b(d(l)("change").toLowerCase()),1),x("div",te,[t(c,{onClick:w,type:"success",disabled:v.value,class:"min-w-[120px]"},{icon:n(()=>[t(y,null,{default:n(()=>[t(d(W))]),_:1})]),default:n(()=>[U(" "+b(d(l)("save"))+" ",1),ae]),_:1},8,["disabled"]),t(c,{onClick:s,type:"warning",class:"min-w-[120px]"},{icon:n(()=>[t(y,null,{default:n(()=>[t(d(X))]),_:1})]),default:n(()=>[U(" "+b(d(l)("exit"))+" ",1),le]),_:1})])]),t(S,{label:d(l)("telegram"),path:"telegram"},{default:n(()=>[t(N,{onKeydown:e,value:o.value.telegram,"onUpdate:value":i[0]||(i[0]=g=>o.value.telegram=g),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),t(S,{label:d(l)("tiktok"),path:"tiktok"},{default:n(()=>[t(N,{onKeydown:e,value:o.value.tiktok,"onUpdate:value":i[1]||(i[1]=g=>o.value.tiktok=g),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),t(S,{label:d(l)("instagram"),path:"instagram"},{default:n(()=>[t(N,{onKeydown:e,value:o.value.instagram,"onUpdate:value":i[2]||(i[2]=g=>o.value.instagram=g),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),t(S,{label:d(l)("phone"),path:"phone"},{default:n(()=>[t(N,{onKeydown:e,value:o.value.phone,"onUpdate:value":i[3]||(i[3]=g=>o.value.phone=g),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["show"])]),_:1},8,["model"])}}},ne={class:"p-2 space-y-2"},oe={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},se={class:"text-xl font-bold"},pe={__name:"Index",setup(E){const{t:a,locale:l}=K();q(),P(),V(),F(),G(),A("fileUrl");const _=f([]),p=f(!1);f(!1);const C=f({text:""}),u=f({create:!1,update:!1,update_id:null}),v=s=>{p.value=!0,I.all(C.value).then(e=>{_.value=e,p.value=!1,s&&(u.value[s]=!1)})},o=H(()=>[{title:"â„–",key:"id",align:"center",width:50,render:(s,e)=>e+1},{title:a("telegram"),key:"telegram"},{title:a("instagram"),key:"instagram"},{title:a("tiktok"),key:"tiktok"},{title:a("phone"),key:"phone"},{title:a("action"),key:"action",align:"center",width:120,render(s){return[B(L,{size:"small",type:"success",onClick:e=>{u.value.update_id=s.id,u.value.update=!0},style:{marginRight:"8px"}},{icon:()=>B(J,{component:Q,size:22})})]}}]),$=s=>u.value[s]=!1,w=s=>v(s);return M(()=>v()),(s,e)=>{const r=m("n-data-table"),i=m("n-card"),y=m("n-modal");return j(),T("div",ne,[x("div",oe,[x("h2",se,b(d(a)("contact")),1)]),t(r,{loading:p.value,columns:o.value,data:_.value,bordered:!0,"single-line":!1,size:"small","scroll-x":400},null,8,["loading","columns","data"]),t(y,{"transform-origin":"center",show:u.value.create,"onUpdate:show":e[2]||(e[2]=c=>u.value.create=c)},{default:n(()=>[t(i,{class:"w-full max-w-3xl",bordered:!1,role:"dialog","aria-modal":"true"},{default:n(()=>[t(D,{onClose:e[0]||(e[0]=c=>$("create")),onCreate:e[1]||(e[1]=c=>w("create")),type:"create"})]),_:1})]),_:1},8,["show"]),t(y,{"transform-origin":"center",show:u.value.update,"onUpdate:show":e[5]||(e[5]=c=>u.value.update=c)},{default:n(()=>[t(i,{class:"w-full max-w-3xl",bordered:!1,role:"dialog","aria-modal":"true"},{default:n(()=>[t(D,{type:"update",id:u.value.update_id,onClose:e[3]||(e[3]=c=>$("update")),onUpdate:e[4]||(e[4]=c=>w("update"))},null,8,["id"])]),_:1})]),_:1},8,["show"])])}}};export{pe as default};
