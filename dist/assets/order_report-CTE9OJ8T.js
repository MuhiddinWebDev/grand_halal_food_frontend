import{b as A,r as h,g as J,c as n,a as t,i as d,v as s,s as e,j as x,n as K,k as b,o as r,G as F,q as w,R as q,S as I,U as k}from"./index-GwBpnSVU.js";import{E as P}from"./eye-Dra6YFIM.js";import{E as Q}from"./exit--WL2js6I.js";import{r as W}from"./report.service-y6CgOxt0.js";import{p as X}from"./product.service-UEhOC2xT.js";import{o as Z}from"./order.service-CheXL7ad.js";import{c as C}from"./NumberFormat-BDrUmd0_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const tt={class:"p-4"},et={class:"bg-white rounded-lg shadow-md"},st={class:"flex justify-between items-center p-4 bg-gray-100 rounded-t-lg"},ot={class:"text-xl font-bold"},at={class:"flex flex-wrap gap-4 p-2"},lt={class:"w-[400px] sm:w-[300px]"},nt={class:"w-full sm:w-64"},dt={class:"w-full sm:w-64"},rt={class:"w-full sm:w-64"},ct={class:"w-full sm:w-auto"},it={class:"p-4"},ut={class:"md:hidden space-y-3"},pt=["onClick"],_t={class:"flex items-start justify-between gap-2"},vt={class:"text-xs text-slate-500"},ht={key:0},xt={key:1,class:"text-xs px-2 py-0.5 rounded bg-gray-200 text-gray-700"},bt={class:"mt-1"},yt={class:"text-slate-500 text-xs"},gt=["title"],ft={class:"mt-2 grid grid-cols-2 gap-2 items-end"},mt={class:"text-slate-500 text-[11px]"},wt={class:"font-semibold"},kt={class:"text-right"},Ct={class:"text-slate-500 text-[11px]"},Lt={class:"font-semibold"},Dt={class:"mt-2 flex justify-end"},St={class:"rounded-lg border p-3 bg-gray-50"},qt={class:"flex justify-between text-sm"},jt={class:"font-semibold"},Et={class:"flex justify-between text-sm mt-1"},Ot={class:"font-semibold"},Rt={key:0,class:"rounded-lg border p-6 bg-white"},Ut={class:"hidden md:block"},Nt={class:"overflow-x-auto"},Vt={class:"min-w-full bg-white shadow-md rounded-lg overflow-hidden border table-auto"},Bt={class:"bg-gray-200 text-left border"},Ft={class:"px-4 py-2 text-sm"},It={class:"px-4 py-2 text-sm"},Tt={class:"px-4 py-2 text-sm"},$t={class:"px-4 py-2 text-sm"},zt={class:"px-4 py-2 text-sm w-[120px]"},Mt=["onDblclick"],Gt={class:"px-4 py-2 border"},Ht=["title"],Yt={class:"px-4 py-2 text-right border"},At={class:"px-4 py-2 text-right border"},Jt={class:"px-4 py-2 border"},Kt={key:1,class:"text-center rounded py-1 bg-gray-200 text-gray-700"},Pt={class:"px-4 py-2 border"},Qt={key:0},Wt={colspan:"6",class:"px-4 py-6 text-center text-slate-500"},Xt={class:"bg-gray-100"},Zt={colspan:"2",class:"px-4 py-2 text-center font-semibold border"},te={class:"px-4 py-2 text-right border"},ee={class:"px-4 py-2 text-right border"},ue={__name:"order_report",setup(se){const{t:o,locale:_}=A(),j=K(),E=h([]),L=new Date,T=new Date(L.getFullYear(),L.getMonth(),1);let y=h(!1),O=h(!0);const p=h({data:[],total_quantity:0,total_amount:0}),D=h([]),$=h([{value:"yes",label:o("yes")},{value:"no",label:o("no")}]),u=h({range:[T.getTime(),L.getTime()],product_id:null,status:null,paid_action:null}),z=async()=>{try{E.value=await X.all(),D.value=await Z.statusOption()}catch(c){console.log(c)}};J(()=>{z()});const v=c=>D.value.find(l=>l.value==c),M=()=>{y.value=!0,O.value=!0,W.orderReport(u.value).then(c=>{p.value=c,y.value=!1,c.data&&c.data.length>0&&(O.value=!1)})},R=c=>{j.push({path:"/sverka-orders",query:{range:u.value.range,product_id:c.product_id,paid_action:c.paid_action?"yes":"no",status:c.status,action:!0}})};return(c,l)=>{const U=b("n-icon"),N=b("n-button"),G=b("n-date-picker"),S=b("n-select"),V=b("n-empty"),H=b("n-spin");return r(),n("div",tt,[t("div",et,[t("div",st,[t("h2",ot,s(e(o)("order report")),1),d(N,{onClick:l[0]||(l[0]=i=>e(j).go(-1)),class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-700"},{icon:x(()=>[d(U,{size:"28"},{default:x(()=>[d(e(Q))]),_:1})]),default:x(()=>[F(" "+s(e(o)("exit")),1)]),_:1})]),t("div",at,[t("div",lt,[d(G,{value:u.value.range,"onUpdate:value":l[1]||(l[1]=i=>u.value.range=i),type:"datetimerange",clearable:"",class:"w-full sm:w-[300px]"},null,8,["value"])]),t("div",nt,[d(S,{options:E.value,value:u.value.product_id,"onUpdate:value":l[2]||(l[2]=i=>u.value.product_id=i),"value-field":"id","label-field":"title_"+e(_),placeholder:e(o)("product"),filterable:"",clearable:"",class:"w-full"},null,8,["options","value","label-field","placeholder"])]),t("div",dt,[d(S,{options:D.value,value:u.value.status,"onUpdate:value":l[3]||(l[3]=i=>u.value.status=i),placeholder:e(o)("order")+" "+e(o)("status").toLocaleLowerCase(),filterable:"",clearable:"",class:"w-full","label-field":"label_"+e(_)},null,8,["options","value","placeholder","label-field"])]),t("div",rt,[d(S,{options:$.value,value:u.value.paid_action,"onUpdate:value":l[4]||(l[4]=i=>u.value.paid_action=i),placeholder:e(o)("paid"),filterable:"",clearable:"",class:"w-full"},null,8,["options","value","placeholder"])]),t("div",ct,[d(N,{type:"success",onClick:M,class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-700 w-full sm:w-auto"},{icon:x(()=>[d(U,null,{default:x(()=>[d(e(P))]),_:1})]),default:x(()=>[F(" "+s(e(o)("see")),1)]),_:1})])]),t("div",it,[d(H,{show:e(y),class:"w-full"},{default:x(()=>{var i,B;return[t("div",ut,[(r(!0),n(q,null,I(p.value.data,(a,g)=>{var f,m;return r(),n("div",{key:g,class:"rounded-lg border p-3 shadow-sm bg-white active:scale-[0.99] transition cursor-pointer",onClick:Y=>R(a)},[t("div",_t,[t("div",vt,"#"+s(g+1),1),a.status?(r(),n("div",ht,[v&&v(a.status)?(r(),n("span",{key:0,class:k(["text-xs px-2 py-0.5 rounded",v(a.status).color])},s(v(a.status)["label_"+e(_)]),3)):(r(),n("span",xt,s(a.status),1))])):w("",!0)]),t("div",bt,[t("div",yt,s(e(o)("product")),1),t("div",{class:"font-medium truncate",title:(f=a.product)==null?void 0:f["title_"+e(_)]},s(((m=a.product)==null?void 0:m["title_"+e(_)])||"â€”"),9,gt)]),t("div",ft,[t("div",null,[t("div",mt,s(e(o)("total"))+" "+s(e(o)("count").toLocaleLowerCase()),1),t("div",wt,s(a.total_quantity||0),1)]),t("div",kt,[t("div",Ct,s(e(o)("total"))+" "+s(e(o)("price").toLocaleLowerCase()),1),t("div",Lt,s(e(C)(a.total_amount||0)),1)])]),t("div",Dt,[t("span",{class:k(["text-xs text-white rounded px-2 py-0.5",a.paid_action?"bg-green-500":"bg-red-500"])},s(a.paid_action?e(o)("yes"):e(o)("no")),3)])],8,pt)}),128)),t("div",St,[t("div",qt,[t("span",null,s(e(o)("total"))+" "+s(e(o)("count").toLocaleLowerCase()),1),t("span",jt,s(p.value.total_quantity||0),1)]),t("div",Et,[t("span",null,s(e(o)("total"))+" "+s(e(o)("price").toLocaleLowerCase()),1),t("span",Ot,s(e(C)(p.value.total_amount||0)),1)])]),!((i=p.value.data)!=null&&i.length)&&!e(y)?(r(),n("div",Rt,[d(V)])):w("",!0)]),t("div",Ut,[t("div",Nt,[t("table",Vt,[t("thead",null,[t("tr",Bt,[l[5]||(l[5]=t("th",{class:"px-4 py-2 text-sm w-10"},"#",-1)),t("th",Ft,s(e(o)("product")),1),t("th",It,s(e(o)("total"))+" "+s(e(o)("count").toLocaleLowerCase()),1),t("th",Tt,s(e(o)("total"))+" "+s(e(o)("price").toLocaleLowerCase()),1),t("th",$t,s(e(o)("status")),1),t("th",zt,s(e(o)("paid")),1)])]),t("tbody",null,[(r(!0),n(q,null,I(p.value.data,(a,g)=>{var f,m;return r(),n("tr",{key:g,class:"border hover:bg-gray-50 cursor-pointer",onDblclick:Y=>R(a)},[t("td",Gt,s(g+1),1),t("td",{class:"px-4 py-2 border max-w-[360px] truncate",title:(f=a.product)==null?void 0:f["title_"+e(_)]},s((m=a.product)==null?void 0:m["title_"+e(_)]),9,Ht),t("td",Yt,s(a.total_quantity),1),t("td",At,s(e(C)(a.total_amount)),1),t("td",Jt,[a.status?(r(),n(q,{key:0},[v&&v(a.status)?(r(),n("div",{key:0,class:k(["text-center rounded py-1",v(a.status).color])},s(v(a.status)["label_"+e(_)]),3)):(r(),n("div",Kt,s(a.status),1))],64)):w("",!0)]),t("td",Pt,[t("div",{class:k(["text-center text-white rounded py-1 px-2",a.paid_action?"bg-green-500":"bg-red-500"])},s(a.paid_action?e(o)("yes"):e(o)("no")),3)])],40,Mt)}),128)),!((B=p.value.data)!=null&&B.length)&&!e(y)?(r(),n("tr",Qt,[t("td",Wt,[d(V)])])):w("",!0),t("tr",Xt,[t("td",Zt,s(e(o)("total")),1),t("td",te,s(p.value.total_quantity||0),1),t("td",ee,s(e(C)(p.value.total_amount||0)),1),l[6]||(l[6]=t("td",{class:"border"},null,-1)),l[7]||(l[7]=t("td",{class:"border"},null,-1))])])])])])]}),_:1},8,["show"])])])])}}};export{ue as default};
