import{R as Y}from"./refresh-Mhw53u75.js";import{D as V}from"./delete-gFvPEINr.js";import{O as h,d as G,h as H,e as J,H as R,r as N,j as T,k as U,o as u,c,a as t,l as r,m as i,p as e,q as C,P as M,Q as $,N as B,G as d,t as l,J as y,T as E,U as F,v as P}from"./index-MvcmIAHN.js";import{c as j}from"./NumberFormat-N2x_sffK.js";import"./_plugin-vue_export-helper-x3n3nnut.js";const _="/order";class L{all(s){return h.get(_+"/all").then(n=>n)}create(s){return h.post(_+"/",s).then(n=>n)}update(s,n){return h.patch(_+`/${s}`,n).then(m=>m)}getOne(s){return h.get(_+`/${s}`).then(n=>n)}delete(s){return h.delete(_+`/${s}`).then(n=>n)}}const x=new L,Q={class:"space-y-4 p-4"},X={class:"flex justify-between items-center"},A=t("h2",{class:"text-2xl font-bold"},"Buyurtmalar",-1),K={key:0},W={class:"space-y-4 grid grid-cols-1 md:grid-cols-2 gap-4"},Z=["href"],tt=["href"],et=t("a",{class:"text-blue-500",href:"https://www.google.com/maps?q={{order.lat}},{{order.lon}}",target:"_blank",style:{"text-decoration":"none"}}," 📍 Google Map ",-1),st={class:"mt-2 space-y-1"},lt={class:"font-semibold text-lg text-bold-700"},at=t("th",{style:{width:"50px","text-align":"center"}},"№",-1),nt={style:{width:"50px","text-align":"center"}},ot={class:"text-right"},rt={class:"text-right"},it={class:"text-right"},ut={class:"flex justify-end gap-2 mt-4"},ct={key:1,class:"flex flex-col items-center justify-center p-6 bg-gray-100 rounded-2xl border border-dashed border-gray-300 shadow-sm"},dt=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-16 w-16 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 3h18M3 7h18M5 11h14M7 15h10M9 19h6"})],-1),ht=t("p",{class:"text-gray-600 text-lg font-medium"},"Buyurtma mavjud emas",-1),_t=[dt,ht],xt={__name:"Index",setup(q){const{t:s,locale:n}=G(),m=H(),z=J(),v=R(),f=N([]),p=N(!1),D=P("dayJS"),g=async()=>{p.value=!0;try{f.value=await x.all()}finally{p.value=!1}},I=async(b,k)=>{try{await x.updateStatus(b,{status:k}),v.success("Status yangilandi")}catch{v.error("Xatolik yuz berdi")}};return T(()=>g()),(b,k)=>{const w=U("n-table");return u(),c("div",Q,[t("div",X,[A,r(e(y),{type:"warning",onClick:g},{icon:i(()=>[r(e(B),null,{default:i(()=>[r(e(Y))]),_:1})]),default:i(()=>[d(" "+l(e(s)("update")),1)]),_:1})]),p.value?(u(),c("div",K,"Yuklanmoqda...")):C("",!0),t("div",W,[(u(!0),c(M,null,$(f.value,a=>(u(),c("div",{key:a.id},[r(e(F),{title:`${e(s)("order")} #${a.id} ${a.client.first_name} ${a.client.last_name}`,size:"medium"},{"header-extra":i(()=>[r(e(E),{value:a.status,"onUpdate:value":[o=>a.status=o,o=>I(a.id,o)],options:e(m).orderStatus,"label-field":"label_"+e(n),size:"small"},null,8,["value","onUpdate:value","options","label-field"])]),default:i(()=>[t("p",null,[t("strong",null,l(e(s)("datetime"))+":",1),d(" "+l(e(D)(a.datetime).format("YYYY-MM-DD HH:mm:ss")),1)]),t("p",null,[t("strong",null,l(e(s)("phone"))+":",1),d(),t("a",{href:"tel:"+a.client.phone_number,class:"text-blue-500"},l(a.client.phone_number),9,Z)]),t("p",null,[t("strong",null,l(e(s)("additional phone number"))+":",1),d(),t("a",{href:"tel:"+a.phone2,class:"text-blue-500"},l(a.phone2),9,tt)]),t("p",null,[t("strong",null,l(e(s)("address"))+":",1),d(" "+l(a.address),1)]),t("p",null,[t("strong",null,l(e(s)("location"))+":",1),et]),t("div",st,[t("h2",lt,l(e(s)("products"))+":",1),r(w,{size:"small",bordered:!0,"single-line":!1},{default:i(()=>[t("thead",null,[t("tr",null,[at,t("th",null,l(e(s)("product")),1),t("th",null,l(e(s)("quantity")),1),t("th",null,l(e(s)("price")),1),t("th",null,l(e(s)("total")+" "+e(s)("summa")),1)])]),t("tbody",null,[(u(!0),c(M,null,$(a.items,(o,O)=>{var S;return u(),c("tr",{key:o.id},[t("td",nt,l(O+1),1),t("td",null,l((S=o.product)==null?void 0:S["title_"+e(n)]),1),t("td",ot,l(o.quantity),1),t("td",rt,l(e(j)(o.price)),1),t("td",it,l(e(j)(o.price*o.quantity)),1)])}),128))])]),_:2},1024)]),t("div",ut,[r(e(y),{size:"small",type:"info",onClick:o=>e(z).push(`/orders/${a.id}`)},{default:i(()=>[d(" Batafsil ")]),_:2},1032,["onClick"]),r(e(y),{size:"small",type:"error",onClick:o=>e(x).delete(a.id).then(g)},{icon:i(()=>[r(e(B),null,{default:i(()=>[r(e(V))]),_:1})]),default:i(()=>[d(" O'chirish ")]),_:2},1032,["onClick"])])]),_:2},1032,["title"])]))),128))]),!p.value&&f.value.length===0?(u(),c("div",ct,_t)):C("",!0)])}}};export{xt as default};
