import{P as R}from"./pen-DW-uAHNt.js";import{O as x,b as K,r as f,g as O,k as p,p as T,o as P,j as o,i as t,a as g,v as h,s as d,G as U,f as V,l as k,P as I,L as F,N as L,c as A}from"./index-Bw_DMt4G.js";import{S as G}from"./save-DP0lGshP.js";import{E as H}from"./exit-fcB5Trvy.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const b="/contact";class q{all(a){let n=a!=null&&a.text?"?text="+a.text:"";return x.get(b+"/all"+n).then(m=>m)}create(a){return x.post(b+"/create",a).then(n=>n)}update(a,n){return x.patch(b+`/update/${a}`,n).then(m=>m)}getOne(a){return x.get(b+`/getById/${a}`).then(n=>n)}delete(a){return x.delete(b+`/delete/${a}`).then(n=>n)}}const z=new q,J={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-4 sm:space-y-0"},Q={class:"text-xl font-semibold"},W={class:"flex gap-2"},D={__name:"Form",props:{type:String,id:[String,Number]},emits:["update","close"],setup(S,{emit:a}){const{t:n,locale:m}=K(),v=S,i=a,C=f(null),w=f(!1);f(null);const r=f({telegram:"",instagram:"",tiktok:"",phone:""}),$={};O(async()=>{if(v.type==="update"&&v.id)try{const u=await z.getOne(v.id);r.value=u}catch(u){console.error("Ma'lumot yuklashda xatolik:",u)}});const e=async()=>{try{if(w.value=!0,v.type==="update"){const u=await z.update(v.id,r.value);i("update",u)}}catch(u){console.warn("Form not valid or failed",u)}finally{w.value=!1}},l=()=>i("close"),y=u=>{u.code==="Enter"&&e()};return(u,s)=>{const c=p("n-icon"),B=p("n-button"),N=p("n-input"),E=p("n-form-item"),j=p("n-spin"),M=p("n-form");return P(),T(M,{ref_key:"formRef",ref:C,model:r.value,rules:$},{default:o(()=>[t(j,{show:w.value},{default:o(()=>[g("div",J,[g("p",Q,h(d(n)("contact"))+" "+h(d(n)("change").toLowerCase()),1),g("div",W,[t(B,{onClick:e,type:"success",disabled:w.value,class:"min-w-[120px]"},{icon:o(()=>[t(c,null,{default:o(()=>[t(d(G))]),_:1})]),default:o(()=>[U(" "+h(d(n)("save"))+" ",1),s[4]||(s[4]=g("span",{class:"text-xs ml-1"},"Enter",-1))]),_:1,__:[4]},8,["disabled"]),t(B,{onClick:l,type:"warning",class:"min-w-[120px]"},{icon:o(()=>[t(c,null,{default:o(()=>[t(d(H))]),_:1})]),default:o(()=>[U(" "+h(d(n)("exit"))+" ",1),s[5]||(s[5]=g("span",{class:"text-xs ml-1"},"Esc",-1))]),_:1,__:[5]})])]),t(E,{label:d(n)("telegram"),path:"telegram"},{default:o(()=>[t(N,{onKeydown:y,value:r.value.telegram,"onUpdate:value":s[0]||(s[0]=_=>r.value.telegram=_),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),t(E,{label:d(n)("tiktok"),path:"tiktok"},{default:o(()=>[t(N,{onKeydown:y,value:r.value.tiktok,"onUpdate:value":s[1]||(s[1]=_=>r.value.tiktok=_),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),t(E,{label:d(n)("instagram"),path:"instagram"},{default:o(()=>[t(N,{onKeydown:y,value:r.value.instagram,"onUpdate:value":s[2]||(s[2]=_=>r.value.instagram=_),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),t(E,{label:d(n)("phone"),path:"phone"},{default:o(()=>[t(N,{onKeydown:y,value:r.value.phone,"onUpdate:value":s[3]||(s[3]=_=>r.value.phone=_),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["show"])]),_:1},8,["model"])}}},X={class:"p-2 space-y-2 bg-white rounded-xl shadow-md overflow-x-auto"},Y={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},Z={class:"text-xl font-bold"},oe={__name:"Index",setup(S){const{t:a}=K(),n=f([]),m=f(!1),v=f({text:""}),i=f({create:!1,update:!1,update_id:null}),C=e=>{m.value=!0,z.all(v.value).then(l=>{n.value=l,m.value=!1,e&&(i.value[e]=!1)})},w=V(()=>[{title:"â„–",key:"id",align:"center",width:50,render:(e,l)=>l+1},{title:a("telegram"),key:"telegram",render(e){return[k(I,{size:"small",type:"success",round:!0,style:{cursor:"pointer"},onClick:()=>{window.open(e.telegram,"_blank")}},{default:()=>e.telegram})]}},{title:a("instagram"),key:"instagram",render(e){return[k(I,{size:"small",type:"error",round:!0,style:{cursor:"pointer"},onClick:()=>{window.open(e.instagram,"_blank")}},{default:()=>e.instagram})]}},{title:a("tiktok"),key:"tiktok",render(e){return[k(I,{size:"small",type:"tertiary",round:!0,style:{cursor:"pointer"},onClick:()=>{window.open(e.tiktok,"_blank")}},{default:()=>e.tiktok})]}},{title:a("phone"),key:"phone",render(e){return[k(I,{size:"small",type:"info",round:!0,style:{cursor:"pointer"},onClick:()=>{window.open(`tel:${e.phone}`,"_self")}},{default:()=>e.phone})]}},{title:a("action"),key:"action",align:"center",fixed:"right",width:120,render(e){return[k(F,{size:"small",type:"success",onClick:l=>{i.value.update_id=e.id,i.value.update=!0},style:{marginRight:"8px"}},{icon:()=>k(L,{component:R,size:22})})]}}]),r=e=>i.value[e]=!1,$=e=>C(e);return O(()=>{C()}),(e,l)=>{const y=p("n-data-table"),u=p("n-card"),s=p("n-modal");return P(),A("div",X,[g("div",Y,[g("h2",Z,h(d(a)("contact")),1)]),t(y,{class:"mobile-table",loading:m.value,columns:w.value,data:n.value,bordered:!0,"single-line":!1,size:"small","scroll-x":1300},null,8,["loading","columns","data"]),t(s,{"transform-origin":"center",show:i.value.create,"onUpdate:show":l[2]||(l[2]=c=>i.value.create=c)},{default:o(()=>[t(u,{class:"w-full max-w-3xl",bordered:!1,role:"dialog","aria-modal":"true"},{default:o(()=>[t(D,{onClose:l[0]||(l[0]=c=>r("create")),onCreate:l[1]||(l[1]=c=>$("create")),type:"create"})]),_:1})]),_:1},8,["show"]),t(s,{"transform-origin":"center",show:i.value.update,"onUpdate:show":l[5]||(l[5]=c=>i.value.update=c)},{default:o(()=>[t(u,{class:"w-full max-w-3xl",bordered:!1,role:"dialog","aria-modal":"true"},{default:o(()=>[t(D,{type:"update",id:i.value.update_id,onClose:l[3]||(l[3]=c=>r("update")),onUpdate:l[4]||(l[4]=c=>$("update"))},null,8,["id"])]),_:1})]),_:1},8,["show"])])}}};export{oe as default};
