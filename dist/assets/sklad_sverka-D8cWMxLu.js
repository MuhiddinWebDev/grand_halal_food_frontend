import{e as G,b as J,r as b,g as O,c as _,a as t,i as n,v as e,s,j as u,n as z,k as h,h as L,m as P,o as p,G as E,q as I,R as M,S as C}from"./index-GwBpnSVU.js";import{E as $}from"./eye-Dra6YFIM.js";import{E as K}from"./exit--WL2js6I.js";import{r as Q}from"./report.service-y6CgOxt0.js";import{p as W}from"./product.service-UEhOC2xT.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"p-4"},Z={class:"bg-white rounded-lg shadow-md"},tt={class:"flex justify-between items-center p-4 bg-gray-100 rounded-t-lg"},et={class:"text-xl font-bold"},st={class:"flex flex-wrap gap-4 p-2"},ot={class:"w-full sm:w-[400px]"},lt={class:"w-full sm:w-64"},at={class:"w-full sm:w-64"},nt={class:"w-full sm:w-auto"},dt={class:"p-4"},ct={class:"md:hidden space-y-3"},it={class:"flex justify-between text-xs text-slate-500"},rt={class:"mt-1 text-sm"},_t={class:"text-slate-500 text-xs"},ut={class:"font-medium truncate"},pt={class:"mt-2 grid grid-cols-2 gap-2"},ht={class:"text-slate-500 text-xs"},vt={class:"font-semibold"},mt={class:"text-right"},xt={class:"text-slate-500 text-xs"},bt={class:"font-semibold"},ft={class:"rounded-lg border p-3 bg-gray-50 sticky bottom-5"},gt={class:"flex justify-between text-sm"},yt={class:"font-semibold"},wt={class:"flex justify-between text-sm mt-1"},kt={class:"font-semibold"},Dt={class:"flex justify-between text-sm mt-1"},Yt={class:"font-semibold"},Nt={key:0,class:"rounded-lg border p-6 bg-white"},St={class:"hidden md:block"},jt={class:"overflow-x-auto"},qt={class:"min-w-full bg-white shadow-md rounded-lg overflow-hidden border table-auto"},Et={class:"bg-gray-200 text-left border"},It={class:"px-4 py-2 text-sm w-[150px]"},Mt={class:"px-4 py-2 text-sm"},Ct={class:"px-4 py-2 text-sm"},Ht={class:"px-4 py-2 text-sm"},Vt={class:"px-4 py-2 border"},Rt={class:"px-4 py-2 border"},Tt={class:"px-4 py-2 border"},Bt={class:"px-4 py-2 text-right border"},Ut={class:"px-4 py-2 text-right border"},At={key:0},Ft={colspan:"5",class:"px-4 py-6 text-center text-slate-500"},Gt={class:"bg-gray-100"},Jt={colspan:"3",class:"px-4 py-2 text-center font-semibold border"},Ot={class:"px-4 py-2 text-right border"},zt={class:"px-4 py-2 text-right border"},Lt={class:"bg-gray-100"},Pt={colspan:"3",class:"px-4 py-2 text-center font-semibold border"},$t={colspan:"2",class:"px-4 py-2 text-center border"},se={__name:"sklad_sverka",setup(Kt){const y=P("dayJS"),H=G(),{t:o,locale:f}=J(),V=L(),R=z(),w=b([]),g=new Date,T=new Date(g.getFullYear(),g.getMonth(),1);let v=b(!1),k=b(!0);const a=b([]),d=b({range:[T.getTime(),g.getTime()],product_id:null,type:null}),B=async()=>{try{w.value=await W.all()}catch(l){console.log(l)}},U=()=>{let l=V.query;l.action&&(d.value.range=l.range?[parseInt(l.range[0]),parseInt(l.range[1])]:null,d.value.product_id=l.product_id?parseInt(l.product_id):null,d.value.type=l.type?l.type:null,D())};O(()=>{B(),U()});const D=()=>{v.value=!0,k.value=!0,Q.omborSverka(d.value).then(l=>{a.value=l,v.value=!1,l.data&&l.data.length>0&&(k.value=!1)})};return(l,c)=>{const Y=h("n-icon"),N=h("n-button"),A=h("n-date-picker"),S=h("n-select"),j=h("n-empty"),F=h("n-spin");return p(),_("div",X,[t("div",Z,[t("div",tt,[t("h2",et,e(s(o)("sklad sverka")),1),n(N,{onClick:c[0]||(c[0]=i=>s(R).go(-1)),class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-700"},{icon:u(()=>[n(Y,{size:"28"},{default:u(()=>[n(s(K))]),_:1})]),default:u(()=>[E(" "+e(s(o)("exit")),1)]),_:1})]),t("div",st,[t("div",ot,[n(A,{value:d.value.range,"onUpdate:value":c[1]||(c[1]=i=>d.value.range=i),type:"datetimerange",clearable:""},null,8,["value"])]),t("div",lt,[n(S,{options:w.value,value:d.value.product_id,"onUpdate:value":c[2]||(c[2]=i=>d.value.product_id=i),"value-field":"id","label-field":"title_"+s(f),placeholder:s(o)("product"),filterable:"",clearable:"",class:"w-full"},null,8,["options","value","label-field","placeholder"])]),t("div",at,[n(S,{options:s(H).skladType,value:d.value.type,"onUpdate:value":c[3]||(c[3]=i=>d.value.type=i),"value-field":"id","label-field":"title_"+s(f),placeholder:s(o)("type"),filterable:"",clearable:"",class:"w-full"},null,8,["options","value","label-field","placeholder"])]),t("div",nt,[n(N,{type:"success",onClick:D,class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-700 w-full sm:w-auto"},{icon:u(()=>[n(Y,null,{default:u(()=>[n(s($))]),_:1})]),default:u(()=>[E(" "+e(s(o)("see")),1)]),_:1})])]),t("div",dt,[n(F,{show:s(v),class:"w-full"},{default:u(()=>{var i,q;return[t("div",ct,[(p(!0),_(M,null,C(a.value.data,(r,m)=>{var x;return p(),_("div",{key:m,class:"rounded-lg border p-3 shadow-sm bg-white"},[t("div",it,[t("span",null,"#"+e(m+1),1),t("span",null,e(s(y)(r.createdAt).format("DD.MM.YYYY HH:mm")),1)]),t("div",rt,[t("div",_t,e(s(o)("product")),1),t("div",ut,e(((x=r.product)==null?void 0:x["title_"+s(f)])||"â€”"),1)]),t("div",pt,[t("div",null,[t("div",ht,e(s(o)("kirim")),1),t("div",vt,e(r.in_total_quantity||0),1)]),t("div",mt,[t("div",xt,e(s(o)("rasxod")),1),t("div",bt,e(r.out_total_quantity||0),1)])])])}),128)),t("div",ft,[t("div",gt,[t("span",null,e(s(o)("total"))+" "+e(s(o)("kirim")),1),t("span",yt,e(a.value.total_in||0),1)]),t("div",wt,[t("span",null,e(s(o)("total"))+" "+e(s(o)("rasxod")),1),t("span",kt,e(a.value.total_out||0),1)]),t("div",Dt,[t("span",null,e(s(o)("limit")),1),t("span",Yt,e((Number(a.value.total_in)||0)-(Number(a.value.total_out)||0)),1)])]),!((i=a.value.data)!=null&&i.length)&&!s(v)?(p(),_("div",Nt,[n(j)])):I("",!0)]),t("div",St,[t("div",jt,[t("table",qt,[t("thead",null,[t("tr",Et,[c[4]||(c[4]=t("th",{class:"px-4 py-2 text-sm w-10"},"#",-1)),t("th",It,e(s(o)("datetime")),1),t("th",Mt,e(s(o)("product")),1),t("th",Ct,e(s(o)("kirim")),1),t("th",Ht,e(s(o)("rasxod")),1)])]),t("tbody",null,[(p(!0),_(M,null,C(a.value.data,(r,m)=>{var x;return p(),_("tr",{key:m,class:"border hover:bg-gray-50"},[t("td",Vt,e(m+1),1),t("td",Rt,e(s(y)(r.createdAt).format("YYYY-MM-DD HH:mm")),1),t("td",Tt,e((x=r.product)==null?void 0:x["title_"+s(f)]),1),t("td",Bt,e(r.in_total_quantity),1),t("td",Ut,e(r.out_total_quantity),1)])}),128)),!((q=a.value.data)!=null&&q.length)&&!s(v)?(p(),_("tr",At,[t("td",Ft,[n(j)])])):I("",!0),t("tr",Gt,[t("td",Jt,e(s(o)("total")),1),t("td",Ot,e(a.value.total_in||0),1),t("td",zt,e(a.value.total_out||0),1)]),t("tr",Lt,[t("td",Pt,e(s(o)("limit")),1),t("td",$t,e((Number(a.value.total_in)||0)-(Number(a.value.total_out)||0)),1)])])])])])]}),_:1},8,["show"])])])])}}};export{se as default};
