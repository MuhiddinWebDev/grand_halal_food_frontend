import{b as z,r as y,g as G,c as r,a as t,i as c,v as e,s,j as p,n as H,k as m,o as u,G as N,q as V,R as B,S as F}from"./index-GwBpnSVU.js";import{E as Y}from"./eye-Dra6YFIM.js";import{E as A}from"./exit--WL2js6I.js";import{r as J}from"./report.service-y6CgOxt0.js";import{p as K}from"./product.service-UEhOC2xT.js";import{c as a}from"./NumberFormat-BDrUmd0_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"p-4"},Q={class:"bg-white rounded-lg shadow-md"},W={class:"flex justify-between items-center p-4 bg-gray-100 rounded-t-lg"},X={class:"text-xl font-bold"},Z={class:"flex flex-wrap gap-4 p-2"},tt={class:"w-[400px] sm:w-[300px]"},st={class:"w-full sm:w-64"},et={class:"w-full sm:w-auto"},ot={class:"p-4"},lt={class:"md:hidden space-y-3"},at=["onClick"],dt={class:"flex items-start justify-between gap-2"},ct={class:"text-xs text-slate-500"},nt={class:"mt-1"},it={class:"text-slate-500 text-xs"},_t=["title"],rt={class:"mt-2 grid grid-cols-2 gap-2"},pt={class:"text-slate-500 text-[11px]"},ut={class:"font-semibold"},ht={class:"text-right"},mt={class:"text-slate-500 text-[11px]"},xt={class:"font-semibold"},vt={class:"text-slate-500 text-[11px]"},ft={class:"font-semibold"},bt={class:"text-right"},gt={class:"text-slate-500 text-[11px]"},yt={class:"font-semibold"},wt={class:"text-slate-500 text-[11px]"},kt={class:"font-semibold"},Ct={class:"text-right"},Lt={class:"text-slate-500 text-[11px]"},jt={class:"font-semibold"},Dt={class:"mt-2 flex justify-end"},Et={class:"text-xs bg-blue-600 text-white rounded px-2 py-0.5"},St={class:"rounded-lg border p-3 bg-gray-50 sticky bottom-5"},Rt={class:"flex justify-between text-sm"},Nt={class:"font-semibold"},Vt={class:"flex justify-between text-sm mt-1"},Bt={class:"font-semibold"},Ft={class:"flex justify-between text-sm mt-1"},It={class:"font-semibold"},Tt={class:"flex justify-between text-sm mt-1"},$t={class:"font-semibold"},qt={class:"flex justify-between text-sm mt-1"},Mt={class:"font-semibold"},Ot={key:0,class:"rounded-lg border p-6 bg-white"},Ut={class:"hidden md:block"},zt={class:"overflow-x-auto"},Gt={class:"min-w-[1000px] w-full bg-white shadow-md rounded-lg overflow-hidden border table-auto"},Ht={class:"bg-gray-100"},Yt={class:"text-left border-b"},At={class:"px-4 py-2 text-sm"},Jt={class:"px-4 py-2 text-sm"},Kt={class:"px-4 py-2 text-sm"},Pt={class:"px-4 py-2 text-sm"},Qt={class:"px-4 py-2 text-sm"},Wt={class:"px-4 py-2 text-sm"},Xt={class:"px-4 py-2 text-sm"},Zt={class:"px-4 py-2 text-sm"},ts=["onDblclick"],ss={class:"px-4 py-2 border"},es=["title"],os={class:"px-4 py-2 text-right border"},ls={class:"px-4 py-2 text-right border"},as={class:"px-4 py-2 text-right border"},ds={class:"px-4 py-2 text-right border"},cs={class:"px-4 py-2 text-right border"},ns={class:"px-4 py-2 text-right border"},is={class:"px-4 py-2 text-right border"},_s={key:0},rs={colspan:"9",class:"px-4 py-6 text-center text-slate-500"},ps={class:"bg-gray-100"},us={colspan:"2",class:"px-4 py-2 text-center font-semibold border"},hs={class:"px-4 py-2 text-right border"},ms={class:"px-4 py-2 text-right border",colspan:"3"},xs={class:"px-4 py-2 text-right border"},vs={class:"px-4 py-2 text-right border"},fs={class:"px-4 py-2 text-right border"},Ds={__name:"most_profitable_report",setup(bs){const{t:o,locale:x}=z(),k=H(),C=y([]),w=new Date,I=new Date(w.getFullYear(),w.getMonth(),1);let v=y(!1),L=y(!0);const d=y({data:[],total_product_count:0,total_discount_summa:0,total_profit_summa:0,total_delivery_summa:0}),h=y({range:[I.getTime(),w.getTime()],product_id:null}),T=async()=>{try{C.value=await K.all()}catch(n){console.log(n)}};G(()=>{T()});const $=()=>{v.value=!0,L.value=!0,J.mostSoldReport(h.value).then(n=>{d.value=n,v.value=!1,n.data&&n.data.length>0&&(L.value=!1)})},j=n=>{k.push({path:"/sverka-most-profit",query:{range:h.value.range,product_id:n.product_id,action:!0}})};return(n,i)=>{const D=m("n-icon"),E=m("n-button"),q=m("n-date-picker"),M=m("n-select"),S=m("n-empty"),O=m("n-spin");return u(),r("div",P,[t("div",Q,[t("div",W,[t("h2",X,e(s(o)("most profitable report")),1),c(E,{onClick:i[0]||(i[0]=_=>s(k).go(-1)),class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-700"},{icon:p(()=>[c(D,{size:"28"},{default:p(()=>[c(s(A))]),_:1})]),default:p(()=>[N(" "+e(s(o)("exit")),1)]),_:1})]),t("div",Z,[t("div",tt,[c(q,{value:h.value.range,"onUpdate:value":i[1]||(i[1]=_=>h.value.range=_),type:"datetimerange",clearable:"",class:"w-full sm:w-[300px]"},null,8,["value"])]),t("div",st,[c(M,{options:C.value,value:h.value.product_id,"onUpdate:value":i[2]||(i[2]=_=>h.value.product_id=_),"value-field":"id","label-field":"title_"+s(x),placeholder:s(o)("product"),filterable:"",clearable:"",class:"w-full"},null,8,["options","value","label-field","placeholder"])]),t("div",et,[c(E,{type:"success",onClick:$,class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-700 w-full sm:w-auto"},{icon:p(()=>[c(D,null,{default:p(()=>[c(s(Y))]),_:1})]),default:p(()=>[N(" "+e(s(o)("see")),1)]),_:1})])]),t("div",ot,[c(O,{show:s(v),class:"w-full"},{default:p(()=>{var _,R;return[t("div",lt,[(u(!0),r(B,null,F(d.value.data,(l,f)=>{var b,g;return u(),r("div",{key:f,class:"rounded-lg border p-3 shadow-sm bg-white active:scale-[0.99] transition cursor-pointer",onClick:U=>j(l)},[t("div",dt,[t("div",ct,"#"+e(f+1),1)]),t("div",nt,[t("div",it,e(s(o)("product")),1),t("div",{class:"font-medium truncate",title:(b=l.product)==null?void 0:b["title_"+s(x)]},e(((g=l.product)==null?void 0:g["title_"+s(x)])||"â€”"),9,_t)]),t("div",rt,[t("div",null,[t("div",pt,e(s(o)("total"))+" "+e(s(o)("count").toLocaleLowerCase()),1),t("div",ut,e(l.product_count||0),1)]),t("div",ht,[t("div",mt,e(s(o)("selling price")),1),t("div",xt,e(s(a)(l.price||0)),1)]),t("div",null,[t("div",vt,e(s(o)("get price")),1),t("div",ft,e(s(a)(l.get_price||0)),1)]),t("div",bt,[t("div",gt,e(s(o)("discount")),1),t("div",yt,e(s(a)(l.discount_summa||0)),1)]),t("div",null,[t("div",wt,e(s(o)("profit")),1),t("div",kt,e(s(a)(l.profit_summa||0)),1)]),t("div",Ct,[t("div",Lt,e(s(o)("delivery_summa")),1),t("div",jt,e(s(a)(l.total_delivery||0)),1)])]),t("div",Dt,[t("span",Et,e(s(o)("total"))+" "+e(s(o)("summa").toLocaleLowerCase())+": "+e(s(a)((l.profit_summa||0)+(l.total_delivery||0))),1)])],8,at)}),128)),t("div",St,[t("div",Rt,[t("span",null,e(s(o)("total"))+" "+e(s(o)("count").toLocaleLowerCase()),1),t("span",Nt,e(d.value.total_product_count||0),1)]),t("div",Vt,[t("span",null,e(s(o)("discount")),1),t("span",Bt,e(s(a)(d.value.total_discount_summa||0)),1)]),t("div",Ft,[t("span",null,e(s(o)("profit")),1),t("span",It,e(s(a)(d.value.total_profit_summa||0)),1)]),t("div",Tt,[t("span",null,e(s(o)("delivery_summa")),1),t("span",$t,e(s(a)(d.value.total_delivery_summa||0)),1)]),t("div",qt,[t("span",null,e(s(o)("total"))+" "+e(s(o)("summa").toLocaleLowerCase()),1),t("span",Mt,e(s(a)((d.value.total_profit_summa||0)+(d.value.total_delivery_summa||0))),1)])]),!((_=d.value.data)!=null&&_.length)&&!s(v)?(u(),r("div",Ot,[c(S)])):V("",!0)]),t("div",Ut,[t("div",zt,[t("table",Gt,[t("thead",Ht,[t("tr",Yt,[i[3]||(i[3]=t("th",{class:"px-4 py-2 text-sm w-10"},"#",-1)),t("th",At,e(s(o)("product")),1),t("th",Jt,e(s(o)("total"))+" "+e(s(o)("count").toLocaleLowerCase()),1),t("th",Kt,e(s(o)("selling price")),1),t("th",Pt,e(s(o)("get price")),1),t("th",Qt,e(s(o)("discount")),1),t("th",Wt,e(s(o)("profit")),1),t("th",Xt,e(s(o)("delivery_summa")),1),t("th",Zt,e(s(o)("total"))+" "+e(s(o)("summa").toLocaleLowerCase()),1)])]),t("tbody",null,[(u(!0),r(B,null,F(d.value.data,(l,f)=>{var b,g;return u(),r("tr",{key:f,class:"border hover:bg-gray-50 cursor-pointer",onDblclick:U=>j(l)},[t("td",ss,e(f+1),1),t("td",{class:"px-4 py-2 border max-w-[360px] truncate",title:(b=l.product)==null?void 0:b["title_"+s(x)]},e((g=l.product)==null?void 0:g["title_"+s(x)]),9,es),t("td",os,e(l.product_count||0),1),t("td",ls,e(s(a)(l.price||0)),1),t("td",as,e(s(a)(l.get_price||0)),1),t("td",ds,e(s(a)(l.discount_summa||0)),1),t("td",cs,e(s(a)(l.profit_summa||0)),1),t("td",ns,e(s(a)(l.total_delivery||0)),1),t("td",is,e(s(a)((l.profit_summa||0)+(l.total_delivery||0))),1)],40,ts)}),128)),!((R=d.value.data)!=null&&R.length)&&!s(v)?(u(),r("tr",_s,[t("td",rs,[c(S)])])):V("",!0),t("tr",ps,[t("td",us,e(s(o)("total")),1),t("td",hs,e(d.value.total_product_count||0),1),t("td",ms,e(s(a)(d.value.total_discount_summa||0)),1),t("td",xs,e(s(a)(d.value.total_profit_summa||0)),1),t("td",vs,e(s(a)(d.value.total_delivery_summa||0)),1),t("td",fs,e(s(a)((d.value.total_profit_summa||0)+(d.value.total_delivery_summa||0))),1)])])])])])]}),_:1},8,["show"])])])])}}};export{Ds as default};
