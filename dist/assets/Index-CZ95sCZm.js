import{d as V,r as f,h as L,l as p,q as H,o as F,k as a,j as e,a as m,x as k,t as o,G as q,e as Z,H as J,f as Q,g as W,m as x,I as X,J as Y,L as P,N as R,p as ee,M as te,w as le,C as ae,c as oe,n as ne}from"./index-BkkmJgWg.js";import{u as se,S as ie}from"./index-Cgcq1nI7.js";import{A as re}from"./add-dc-c3G9A.js";import{R as ue}from"./refresh-DtjYAjoi.js";import{P as ce}from"./pen-Q6q8DIA4.js";import{D as de}from"./delete-Bo7FBPv5.js";import{b as U}from"./brand.service-BAAqNORG.js";import{c as pe}from"./category.service-DbdBssxL.js";import{S as me,E as fe}from"./exit-DaC2qT7A.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const _e={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-4 sm:space-y-0"},ve={class:"text-xl font-semibold"},ge={class:"flex gap-2"},ye={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4"},T={__name:"Form",props:{type:String,id:[String,Number]},emits:["create","update","close"],setup(j,{emit:i}){const{t:u,locale:M}=V(),_=j,I=i,E=f(null),C=f(!1),N=f(null),B=f([]),r=f({title_uz:"",title_ru:"",title_ko:"",title_en:"",category_id:null}),$=()=>{pe.all().then(s=>{B.value=s})},g=s=>({required:!0,trigger:"blur",validator:(l,z)=>{if(!z)return new Error(u(s==="image"?"require_image":"require_name"))}}),S={title_uz:g("title_uz"),title_ko:g("title_ko"),title_ru:g("title_ru"),title_en:g("title_en"),category_id:{required:!0,trigger:"blur",validator:(s,l)=>{if(!l)return new Error(u("require_category"))}}};L(async()=>{if($(),_.type==="update"&&_.id)try{const s=await U.getOne(_.id);r.value=s}catch(s){console.error("Ma'lumot yuklashda xatolik:",s)}setTimeout(()=>{var s;(s=N.value)==null||s.focus()},100)});const d=async()=>{var s;try{if(await((s=E.value)==null?void 0:s.validate()),C.value=!0,_.type==="create"){const l=await U.create(r.value);I("create",l)}else if(_.type==="update"){const l=await U.update(_.id,r.value);I("update",l)}}catch(l){console.warn("Form not valid or failed",l)}finally{C.value=!1}},y=()=>I("close"),b=s=>{s.code==="Enter"&&d()};return(s,l)=>{const z=p("n-icon"),K=p("n-button"),A=p("n-select"),w=p("n-form-item"),h=p("n-input"),n=p("n-spin"),t=p("n-form");return F(),H(t,{ref_key:"formRef",ref:E,model:r.value,rules:S},{default:a(()=>[e(n,{show:C.value},{default:a(()=>[m("div",_e,[m("p",ve,k(o(u)("brand"))+" "+k(_.type=="create"?o(u)("add").toLowerCase():o(u)("change").toLowerCase()),1),m("div",ge,[e(K,{onClick:d,type:"success",disabled:C.value,class:"min-w-[120px]"},{icon:a(()=>[e(z,null,{default:a(()=>[e(o(me))]),_:1})]),default:a(()=>[q(" "+k(o(u)("save"))+" ",1),l[5]||(l[5]=m("span",{class:"text-xs ml-1"},"Enter",-1))]),_:1,__:[5]},8,["disabled"]),e(K,{onClick:y,type:"warning",class:"min-w-[120px]"},{icon:a(()=>[e(z,null,{default:a(()=>[e(o(fe))]),_:1})]),default:a(()=>[q(" "+k(o(u)("exit"))+" ",1),l[6]||(l[6]=m("span",{class:"text-xs ml-1"},"Esc",-1))]),_:1,__:[6]})])]),e(w,{label:o(u)("category"),path:"category_id"},{default:a(()=>[e(A,{options:B.value,fitlerable:"",clearable:"",onKeydown:b,value:r.value.category_id,"onUpdate:value":l[0]||(l[0]=c=>r.value.category_id=c),"label-field":"title_"+o(M),"value-field":"id"},null,8,["options","value","label-field"])]),_:1},8,["label"]),m("div",ye,[e(w,{label:o(u)("title")+" UZB",path:"title_uz"},{default:a(()=>[e(h,{ref_key:"inputInstRef",ref:N,onKeydown:b,value:r.value.title_uz,"onUpdate:value":l[1]||(l[1]=c=>r.value.title_uz=c),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),e(w,{label:o(u)("title")+" KOR",path:"title_ko"},{default:a(()=>[e(h,{onKeydown:b,value:r.value.title_ko,"onUpdate:value":l[2]||(l[2]=c=>r.value.title_ko=c),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),e(w,{label:o(u)("title")+" RUS",path:"title_ru"},{default:a(()=>[e(h,{onKeydown:b,value:r.value.title_ru,"onUpdate:value":l[3]||(l[3]=c=>r.value.title_ru=c),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),e(w,{label:o(u)("title")+" ENG",path:"title_en"},{default:a(()=>[e(h,{onKeydown:b,value:r.value.title_en,"onUpdate:value":l[4]||(l[4]=c=>r.value.title_en=c),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"])])]),_:1},8,["show"])]),_:1},8,["model"])}}},we={class:"p-2 space-y-2 bg-white rounded-xl shadow-md overflow-x-auto"},xe={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},be={class:"text-xl font-bold"},he={class:"flex flex-col sm:flex-row gap-2 sm:items-center"},$e={__name:"Index",setup(j){const{t:i,locale:u}=V(),{insert:M,shift:_,r:I}=se(),E=ee(),C=Z(),N=J(),B=Q(),r=ne("fileUrl"),$=f([]),g=f(!1);f(!1);const S=f({text:""}),d=f({create:!1,update:!1,update_id:null}),y=n=>{g.value=!0,U.all(S.value).then(t=>{$.value=t,g.value=!1,n&&(d.value[n]=!1)})},b=W(()=>[{title:"â„–",key:"id",align:"center",width:50,render:(n,t)=>t+1},{title:i("category"),key:"title",render(n){var t,c,D;return x("div",{class:"flex items-center"},[(t=n.category)!=null&&t.image?x(X,{src:r+((c=n.category)==null?void 0:c.image),height:35,width:50,style:{borderRadius:"35px",marginRight:"8px"},lazy:!0,previewDisabled:!0}):x(Y,{size:"small",style:{marginRight:"8px"}}),x("span",{class:"font-semibold"},(D=n.category)==null?void 0:D["title_"+u.value])])}},{title:i("title")+" UZB",key:"title_uz"},{title:i("title")+" KOR",key:"title_ko"},{title:i("title")+" RUS",key:"title_ru"},{title:i("title")+" ENG",key:"title_en"},{title:i("action"),key:"action",align:"center",width:120,fixed:"right",render(n){return[x(P,{size:"small",type:"success",onClick:t=>{d.value.update_id=n.id,d.value.update=!0},style:{marginRight:"8px"}},{icon:()=>x(R,{component:ce,size:22})}),x(P,{size:"small",type:"warning",onClick:()=>{C.warning({title:i("warning"),content:i("delete_row"),positiveText:i("yes"),negativeText:i("no"),onPositiveClick:()=>{U.delete(n.id).then(()=>y()).catch(t=>{B.errorPage=t.data,E.push({name:"error page"})})},onNegativeClick:()=>N.success(i("cancel"))})}},{icon:()=>x(R,{component:de,size:22})})]}}]),s=te({page:1,pageSize:10,showSizePicker:!0,pageSizes:[10,15,20],onChange:n=>s.page=n,onUpdatePageSize:n=>{s.pageSize=n,s.page=1}}),l=n=>({style:"cursor: pointer;"}),z=()=>y(),K=()=>{S.value.text="",y()},A=()=>d.value.create=!0,w=n=>d.value[n]=!1,h=n=>y(n);return le(M,n=>n&&A()),ae(()=>{_.value&&I.value&&y()}),L(()=>y()),(n,t)=>{const c=p("n-input"),D=p("n-data-table"),G=p("n-card"),O=p("n-modal");return F(),oe("div",we,[m("div",xe,[m("h2",be,k(o(i)("brand")),1),m("div",he,[e(c,{value:S.value.text,"onUpdate:value":t[0]||(t[0]=v=>S.value.text=v),onInput:z,placeholder:o(i)("search"),clearable:"",class:"w-full sm:w-80"},{prefix:a(()=>[e(o(R),null,{default:a(()=>[e(o(ie))]),_:1})]),_:1},8,["value","placeholder"]),e(o(P),{type:"warning",onClick:K},{icon:a(()=>[e(o(R),null,{default:a(()=>[e(o(ue))]),_:1})]),default:a(()=>[q(" "+k(o(i)("update"))+" ",1),t[7]||(t[7]=m("span",{class:"ml-1 text-xs"},"Shift+R",-1))]),_:1,__:[7]}),e(o(P),{type:"success",onClick:A},{icon:a(()=>[e(o(R),null,{default:a(()=>[e(o(re))]),_:1})]),default:a(()=>[q(" "+k(o(i)("add"))+" ",1),t[8]||(t[8]=m("span",{class:"ml-1 text-xs"},"Insert",-1))]),_:1,__:[8]})])]),e(D,{"row-props":l,pagination:s,loading:g.value,columns:b.value,data:$.value,bordered:!0,"single-line":!1,size:"small","scroll-x":1300,"max-height":"calc(100vh - 315px)"},null,8,["pagination","loading","columns","data"]),e(O,{"transform-origin":"center",show:d.value.create,"onUpdate:show":t[3]||(t[3]=v=>d.value.create=v)},{default:a(()=>[e(G,{class:"w-full max-w-3xl",bordered:!1,role:"dialog","aria-modal":"true"},{default:a(()=>[e(T,{onClose:t[1]||(t[1]=v=>w("create")),onCreate:t[2]||(t[2]=v=>h("create")),type:"create"})]),_:1})]),_:1},8,["show"]),e(O,{"transform-origin":"center",show:d.value.update,"onUpdate:show":t[6]||(t[6]=v=>d.value.update=v)},{default:a(()=>[e(G,{class:"w-full max-w-3xl",bordered:!1,role:"dialog","aria-modal":"true"},{default:a(()=>[e(T,{type:"update",id:d.value.update_id,onClose:t[4]||(t[4]=v=>w("update")),onUpdate:t[5]||(t[5]=v=>h("update"))},null,8,["id"])]),_:1})]),_:1},8,["show"])])}}};export{$e as default};
