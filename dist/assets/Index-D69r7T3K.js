import{P}from"./pen-BAir8Ts6.js";import{O as y,d as K,r as f,h as O,l as m,q as R,o as j,k as l,j as e,a as g,x as b,t as i,G as B,g as V,m as U,L as F,N as L,c as T}from"./index-AFM4ajz-.js";import{S as q,E as A}from"./exit-BsG4ondb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const k="/contact";class G{all(t){let a=t!=null&&t.text?"?text="+t.text:"";return y.get(k+"/all"+a).then(p=>p)}create(t){return y.post(k+"/create",t).then(a=>a)}update(t,a){return y.patch(k+`/update/${t}`,a).then(p=>p)}getOne(t){return y.get(k+`/getById/${t}`).then(a=>a)}delete(t){return y.delete(k+`/delete/${t}`).then(a=>a)}}const N=new G,H={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-4 sm:space-y-0"},J={class:"text-xl font-semibold"},Q={class:"flex gap-2"},D={__name:"Form",props:{type:String,id:[String,Number]},emits:["update","close"],setup(I,{emit:t}){const{t:a,locale:p}=K(),v=I,d=t,h=f(null),x=f(!1);f(null);const s=f({telegram:"",instagram:"",tiktok:"",phone:""}),C={};O(async()=>{if(v.type==="update"&&v.id)try{const u=await N.getOne(v.id);s.value=u}catch(u){console.error("Ma'lumot yuklashda xatolik:",u)}});const r=async()=>{try{if(x.value=!0,v.type==="update"){const u=await N.update(v.id,s.value);d("update",u)}}catch(u){console.warn("Form not valid or failed",u)}finally{x.value=!1}},n=()=>d("close"),w=u=>{u.code==="Enter"&&r()};return(u,o)=>{const c=m("n-icon"),S=m("n-button"),$=m("n-input"),E=m("n-form-item"),z=m("n-spin"),M=m("n-form");return j(),R(M,{ref_key:"formRef",ref:h,model:s.value,rules:C},{default:l(()=>[e(z,{show:x.value},{default:l(()=>[g("div",H,[g("p",J,b(i(a)("contact"))+" "+b(i(a)("change").toLowerCase()),1),g("div",Q,[e(S,{onClick:r,type:"success",disabled:x.value,class:"min-w-[120px]"},{icon:l(()=>[e(c,null,{default:l(()=>[e(i(q))]),_:1})]),default:l(()=>[B(" "+b(i(a)("save"))+" ",1),o[4]||(o[4]=g("span",{class:"text-xs ml-1"},"Enter",-1))]),_:1,__:[4]},8,["disabled"]),e(S,{onClick:n,type:"warning",class:"min-w-[120px]"},{icon:l(()=>[e(c,null,{default:l(()=>[e(i(A))]),_:1})]),default:l(()=>[B(" "+b(i(a)("exit"))+" ",1),o[5]||(o[5]=g("span",{class:"text-xs ml-1"},"Esc",-1))]),_:1,__:[5]})])]),e(E,{label:i(a)("telegram"),path:"telegram"},{default:l(()=>[e($,{onKeydown:w,value:s.value.telegram,"onUpdate:value":o[0]||(o[0]=_=>s.value.telegram=_),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),e(E,{label:i(a)("tiktok"),path:"tiktok"},{default:l(()=>[e($,{onKeydown:w,value:s.value.tiktok,"onUpdate:value":o[1]||(o[1]=_=>s.value.tiktok=_),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),e(E,{label:i(a)("instagram"),path:"instagram"},{default:l(()=>[e($,{onKeydown:w,value:s.value.instagram,"onUpdate:value":o[2]||(o[2]=_=>s.value.instagram=_),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"]),e(E,{label:i(a)("phone"),path:"phone"},{default:l(()=>[e($,{onKeydown:w,value:s.value.phone,"onUpdate:value":o[3]||(o[3]=_=>s.value.phone=_),"show-count":"",clearable:""},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["show"])]),_:1},8,["model"])}}},W={class:"p-2 space-y-2"},X={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},Y={class:"text-xl font-bold"},ne={__name:"Index",setup(I){const{t}=K(),a=f([]),p=f(!1),v=f({text:""}),d=f({create:!1,update:!1,update_id:null}),h=r=>{p.value=!0,N.all(v.value).then(n=>{a.value=n,p.value=!1,r&&(d.value[r]=!1)})},x=V(()=>[{title:"â„–",key:"id",align:"center",width:50,render:(r,n)=>n+1},{title:t("telegram"),key:"telegram"},{title:t("instagram"),key:"instagram"},{title:t("tiktok"),key:"tiktok"},{title:t("phone"),key:"phone"},{title:t("action"),key:"action",align:"center",fixed:"right",width:120,render(r){return[U(F,{size:"small",type:"success",onClick:n=>{d.value.update_id=r.id,d.value.update=!0},style:{marginRight:"8px"}},{icon:()=>U(L,{component:P,size:22})})]}}]),s=r=>d.value[r]=!1,C=r=>h(r);return O(()=>{h()}),(r,n)=>{const w=m("n-data-table"),u=m("n-card"),o=m("n-modal");return j(),T("div",W,[g("div",X,[g("h2",Y,b(i(t)("contact")),1)]),e(w,{class:"mobile-table",loading:p.value,columns:x.value,data:a.value,bordered:!0,"single-line":!1,size:"small","scroll-x":1300},null,8,["loading","columns","data"]),e(o,{"transform-origin":"center",show:d.value.create,"onUpdate:show":n[2]||(n[2]=c=>d.value.create=c)},{default:l(()=>[e(u,{class:"w-full max-w-3xl",bordered:!1,role:"dialog","aria-modal":"true"},{default:l(()=>[e(D,{onClose:n[0]||(n[0]=c=>s("create")),onCreate:n[1]||(n[1]=c=>C("create")),type:"create"})]),_:1})]),_:1},8,["show"]),e(o,{"transform-origin":"center",show:d.value.update,"onUpdate:show":n[5]||(n[5]=c=>d.value.update=c)},{default:l(()=>[e(u,{class:"w-full max-w-3xl",bordered:!1,role:"dialog","aria-modal":"true"},{default:l(()=>[e(D,{type:"update",id:d.value.update_id,onClose:n[3]||(n[3]=c=>s("update")),onUpdate:n[4]||(n[4]=c=>C("update"))},null,8,["id"])]),_:1})]),_:1},8,["show"])])}}};export{ne as default};
